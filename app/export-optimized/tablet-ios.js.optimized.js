/*!
 * Joshfire Framework 0.9.1
 * http://framework.joshfire.com/
 *
 * Copyright 2011, Joshfire
 * Dual licensed under the GPL Version 2 and a Commercial license.
 * http://framework.joshfire.com/license
 *
 * Date: Wed Jul 20 20:23:43 2011
 */(function(){var a;a={version:[0,9,1],onReady:function(a){a()},adapter:"ios",adapterModules:{ios:["app","uielement","inputs/touch","uielements/list","uielements/mediacontrols","uielements/panel","uielements/video.mediaelement","uielements/video.youtube","utils/datasource"]},adapterDeps:[],debug:!1,basePath:"joshfire/",requirePath:""};var b=function(b){var c,d=[a.adapter].concat(a.adapterDeps);for(var e=0,f=b.length;e<f;e++){b[e]=b[e].replace(/\{adapter\}/g,a.adapter);var g=/^noadapter\!/.test(b[e]);g&&(b[e]=b[e].substring(10));if(/^joshfire\//.test(b[e])){var h=b[e].substring(9);b[e]=a.basePath+h;for(var i=0,j=d.length;i<j&&!g;i++){var k=!1;for(var l=0,m=a.adapterModules[d[i]].length;l<m;l++)if(a.adapterModules[d[i]][l]===h){b[e]=b[e].replace(h,"adapters/"+d[i]+"/"+h),k=!0;break}if(k===!0)break}}else b[e]=a.requirePath+b[e]}return b};a.define=function(a,c){define(b(a),c)},a.require=function(c,d){var e={};a.debug&&a.adapter!="node"&&(e.urlArgs="bust="+(new Date).getTime()),require(e,b(c),d)},this.Joshfire=a,typeof module!="undefined"&&module.exports&&(module.exports.Joshfire=a)})(),function(a){a.onReady=function(b){a.require(["joshfire/vendor/zepto"],function(a){b.call()})}}(Joshfire),Joshfire.definedModules={},Joshfire.loadedModules={},Joshfire.loadModule=function(a){return Joshfire.loadedModules[a]||(Joshfire.loadedModules[a]=Joshfire.definedModules[a](),Joshfire.definedModules[a]=!0),Joshfire.loadedModules[a]},Joshfire.compiled=1333454509113;var require=function(a,b,c){a.length&&(c=b,b=a);var d=[];typeof b=="string"&&(b=[b]);for(var e=0;e<b.length;e++){Joshfire.definedModules[b[e]]||(b[e]="joshfire/"+b[e]);if(!Joshfire.definedModules[b[e]])throw new Error(b[e]+" was not included, please reference it in build.js");d.push(Joshfire.loadModule(b[e]))}c.apply(this,d)};Joshfire.definedModules["joshfire/vendor/underscore"]=function(){return function(){function B(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&x.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&x.isFunction(b.isEqual))return b.isEqual(a);var d=j.call(a);if(d!=j.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&B(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(k.call(a,h)){f++;if(!(g=k.call(b,h)&&B(a[h],b[h],c)))break}if(g){for(h in b)if(k.call(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.concat,i=d.unshift,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return new D(a)};x.VERSION="1.2.3";var y=x.each=x.forEach=function(a,b,d){if(a==null)return;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(k.call(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=function(a,b,c){var d=[];return a==null?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=x.toArray(a).reverse();return d&&!e&&(b=x.bind(b,d)),e?x.reduce(f,b,c,d):x.reduce(f,b)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return a==null?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return a==null?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,d){var e=!0;return a==null?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var z=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return a==null?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};x.include=x.contains=function(a,b){var c=!1;return a==null?c:s&&a.indexOf===s?a.indexOf(b)!=-1:(c=z(a,function(a){return a===b}),c)},x.invoke=function(a,b){var c=g.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-Infinity;var d={computed:-Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return Infinity;var d={computed:Infinity};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b=[],c;return y(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={},d=x.isFunction(b)?b:function(a){return a[b]};return y(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?g.call(a):x.isArguments(a)?g.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},x.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},x.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},x.rest=x.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a,b){return x.reduce(a,function(a,c){return x.isArray(c)?a.concat(b?c:x.flatten(c)):(a[a.length]=c,a)},[])},x.without=function(a){return x.difference(a,g.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return x.reduce(d,function(c,d,f){if(0==f||(b===!0?x.last(c)!=d:!x.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=x.intersect=function(a){var b=g.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=x.flatten(g.call(arguments,1));return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){var a=g.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(a==null)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var A=function(){};x.bind=function(b,c){var d,e;if(b.bind===w&&w)return w.apply(b,g.call(arguments,1));if(!x.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){A.prototype=b.prototype;var a=new A,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},x.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(g.call(arguments,1)))},x.throttle=function(a,b){var c,d,e,f,g,h=x.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},x.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},x.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=h.apply([a],arguments);return b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])}),a},x.defaults=function(a){return y(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a},x.isEqual=function(a,b){return B(a,b,[])},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return a.length===0;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&a.nodeType==1},x.isArray=u||function(a){return j.call(a)=="[object Array]"},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return j.call(a)=="[object Arguments]"},x.isArguments(arguments)||(x.isArguments=function(a){return!!a&&!!k.call(a,"callee")}),x.isFunction=function(a){return j.call(a)=="[object Function]"},x.isString=function(a){return j.call(a)=="[object String]"},x.isNumber=function(a){return j.call(a)=="[object Number]"},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||j.call(a)=="[object Boolean]"},x.isDate=function(a){return j.call(a)=="[object Date]"},x.isRegExp=function(a){return j.call(a)=="[object RegExp]"},x.isNull=function(a){return a===null},x.isUndefined=function(a){return a===void 0},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){F(b,x[b]=a[b])})};var C=0;x.uniqueId=function(a){var b=C++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);if(b)return e(b,x);var f=function(a){return e.call(this,a,x)};return f.func=e,f};var D=function(a){this._wrapped=a};x.prototype=D.prototype;var E=function(a,b){return b?x(a).chain():a},F=function(a,b){D.prototype[a]=function(){var a=g.call(arguments);return i.call(a,this._wrapped),E(b.apply(x,a),this._chain)}};return x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];D.prototype[a]=function(){return b.apply(this._wrapped,arguments),E(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=d[a];D.prototype[a]=function(){return E(b.apply(this._wrapped,arguments),this._chain)}}),D.prototype.chain=function(){return this._chain=!0,this},D.prototype.value=function(){return this._wrapped},x}()},Joshfire.definedModules["joshfire/class"]=function(){return function(a){var b=!1,c=/xyz/.test(function(){xyz})?/\b__super\b/:/.*/,d=function(){};return d.extend=function(a){function g(){!b&&this.__constructor&&this.__constructor.apply(this,arguments)}var d=this.prototype;b=!0;var e=new this;b=!1;for(var f in a)e[f]=typeof a[f]=="function"&&typeof d[f]=="function"&&c.test(a[f])?function(a,b){return function(){var c=this.__super;this.__super=d[a];var e=b.apply(this,arguments);return this.__super=c,e}}(f,a[f]):a[f];return g.prototype=e,g.constructor=g,g.extend=arguments.callee,g},function(){return a.isFunction(arguments[0])?arguments[0].extend(arguments[1]):d.extend(arguments[0])}}(Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/main"]=function(){return function(){return Joshfire}()},Joshfire.definedModules["joshfire/mixins/pubsub"]=function(){return function(a){return{mixin:function(b){b.__pubsubSubscribes=!1,b.__pubsubLastUid=-1,b.publish=function(b,c,d){a.debug&&b!="timeupdate"&&console.log("publish",this.id,b,c,d);if(!this.__pubsubSubscribes.hasOwnProperty(b)&&!this.__pubsubSubscribes.hasOwnProperty("*"))return!1;var e=this,f=function(){var a=(e.__pubsubSubscribes[b]||[]).concat(e.__pubsubSubscribes["*"]||[]),d=function(a){return function(){throw a}};for(var f=0,g=a.length;f<g;f++)a[f]&&a[f].func(b,c,a[f].token)};return d===!0?f():setTimeout(f,0),!0},b.subscribe=function(a,b){this.__pubsubSubscribes===!1&&(this.__pubsubSubscribes={}),this.__pubsubSubscribes.hasOwnProperty(a)||(this.__pubsubSubscribes[a]=[]);var c=(++this.__pubsubLastUid).toString();return this.__pubsubSubscribes[a].push({token:c,func:b}),c},b.unsubscribe=function(a){for(var b in this.__pubsubSubscribes)if(this.__pubsubSubscribes.hasOwnProperty(b))for(var c=0,d=this.__pubsubSubscribes[b].length;c<d;c++)if(this.__pubsubSubscribes[b][c].token===a)return this.__pubsubSubscribes[b].splice(c,1),a;return!1}}}}(Joshfire.loadModule("joshfire/main"))},Joshfire.definedModules["joshfire/mixins/state"]=function(){return function(a){return{mixin:function(b){b.setState=function(b,c){this.__stateStore||(this.__stateStore={}),a.isEqual(this.__stateStore[b],c)||(this.__stateStore[b]=c,this.publish("state",[b,c],!0))},b.setStates=function(b){this.__stateStore||(this.__stateStore={});var c=this,d=[];a.each(b,function(b,e){a.isEqual(c.__stateStore[e],b)||(c.__stateStore[e]=b,d.push([e,b]))}),a.each(d,function(a){c.publish("state",a,!0)})},b.deleteState=function(a){this.__stateStore||(this.__stateStore={}),delete this.__stateStore[a]},b.onState=function(a,b,c){this.getState(a)==b&&c(),this.subscribe("state",function(d,e){e[0]==a&&e[1]==b&&c()})},b.getState=function(a){return this.__stateStore||(this.__stateStore={}),a?this.__stateStore[a]:this.__stateStore}}}}(Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/vendor/json2"]=function(){return function(){return window.JSON||(window.JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),window.JSON=JSON,JSON}()},Joshfire.definedModules["joshfire/tree"]=function(){return function(a,b,c,d,e,f){var g=b({allowRootAccess:!1,inverses:{down:"up",up:"down",next:"prev",prev:"next"},__constructor:function(a,b,c){this.app=a,this.options=e.extend({defaultQuery:{limit:20,skip:0}},c||{}),this.id=b,this.id2index={},this.beingLoaded={},this.stateChangeSerial=1,this.tree={},this.childrenFunctions={},this.queryCache={},this.itemCache={},this.init()},init:function(){},setup:function(a){this.options.tree?this.set("/",this.options.tree,a):this.set("/",this.buildTree?this.buildTree():[],a)},moveTo:function(a,b,c){var d=this;if(!b)return;if(d.isDirectory(b)){var e=!0;d.resolveMoves(b.substring(0,b.length-1),["down"],c,function(b,c){e=!1,d.setState(a,c)}),e&&d.setState(a,b)}else d.setState(a,b);return},move:function(a,b,c){var d=this,e=++d.stateChangeSerial;if(!b)return;var f=!0;d.resolveMoves(d.getState(a),b,c,function(b,c){f=!1,e==d.stateChangeSerial&&d.moveTo(a,c)}),f&&(b=="down"||b.length==1&&b[0]=="down")&&d.setState(a,(d.getState(a)+"/").replace(/\/\/$/,"/"))},compactMoves:function(a){if(a.length<2)return[].concat(a);var b=[];for(var c=0;c<a.length;c++)c<a.length-1&&a[c]==this.inverses[a[c+1]]?c++:b.push(a[c]);return b},resolveMoves:function(a,b,c,d){var f=this;e.isString(b)?b=[b]:b=[].concat(b),this.isDirectory(a)&&(a=this.getDirName(a),b.unshift("down")),b=[].concat(this.compactMoves(b));var g=function(a,h,i){if(a)return d(a);if(b.length===0)return d(null,h,i);var j=b.shift();if(j=="up")f._resolveMoveUp(h,g);else if(j=="next")f._resolveMoveNextPrev(h,1,g);else if(j=="prev")f._resolveMoveNextPrev(h,-1,g);else if(j=="down"){var k=e.indexOf(b,"down")==-1;f._resolveMoveDown(h,k?c:!1,g)}};g(null,a)},_resolveMoveNextPrev:function(a,b,c){var d=this.getDirName(a)+"/",e=this.getBaseName(a),f=this.id2index[d][e];f+=b,f>=0&&f<this.tree[d].length&&(a=d+this.tree[d][f].id),c(null,a)},_resolveMoveUp:function(a,b){var c=this.getDirName(a);if(c!==""||this.allowRootAccess)a=c;b(null,a)},_resolveMoveDown:function(a,b,c){var d=this;if(d.childrenFunctions[a]){b=d._prepareQuery(b);var g=function(e,f,g,h){if(e)return c(e);if(!h){d.addToQueryCache(a,b,f,g);for(var i=0,j=f.length;i<j;i++)d.addToItemCache(a+"/"+f[i].id,f[i],g);d.insert(a+"/",b,f,g)}f.length?(a=a+"/"+d.tree[a+"/"][0].id,c(null,a,f)):c(null,a,[])},h=d.checkQueryCache(a,b);if(h){g(null,h.data,h.options,!0);return}var i=a+"/ "+f.stringify(b);if(d.beingLoaded[i]){d.beingLoaded[i].push(g);return}d.beingLoaded[i]=[g],d.publish("loading",[a+"/",b],!0),d.childrenFunctions[a](b,function(a,b,c){var f=d.beingLoaded[i];delete d.beingLoaded[i],e.each(f,function(d){d(a,b,c||{})})})}else if(d.tree[a+"/"]){if(d.tree[a+"/"]!="loading"){d.tree[a+"/"].length>0&&(a=a+"/"+d.tree[a+"/"][0].id);var j=this.getDirName(a)+"/";c(null,a,this.get(j))}}else c(null,a,[])},_prepareQuery:function(a){return a=e.extend({},this.options.defaultQuery,a||{}),a},checkQueryCache:function(a,b){var c=f.stringify(b);if(this.queryCache[a]&&this.queryCache[a][c]){if(+(new Date)<this.queryCache[a][c].expires)return this.queryCache[a][c];delete this.queryCache[a][c]}return null},addToQueryCache:function(a,b,c,d){var e=d.cache;if(!e)return;var g=f.stringify(b);this.queryCache[a]||(this.queryCache[a]={}),this.queryCache[a][g]={expires:+(new Date)+e*1e3,data:c,options:d}},checkItemCache:function(a){if(this.itemCache[a]){if(+(new Date)<this.itemCache[a].expires)return this.itemCache[a].data;delete this.itemCache[a]}return null},addToItemCache:function(a,b,c){var d=c.cache;if(!d)return;this.itemCache[a]={expires:+(new Date)+d*1e3,data:b,options:c}},get:function(a){if(this.isDirectory(a))return this.tree[a];var b;a===""?b="":b=this.getDirName(a)+"/";var c=this.getBaseName(a);if(this.tree[b]&&this.id2index[b]!==null){var d=this.id2index[b][c];if(d!==null)return this.tree[b][d]}return null},fetch:function(a,b,c){var d=this;if(a=="/")return c(null,d.get("/"));var e=d.isDirectory(a),f=a.substring(1).split("/"),g="";if(!e){var h=this.checkItemCache(a);if(h)return c(null,h)}var i=function(){d.resolveMoves(g,["down"],f.length==1?b:!1,function(b,h,j){f.length==1?e?c(null,j):c(null,d.get(a)):(g+="/"+f.shift(),i())})};i()},isDirectory:function(a){return a.charAt(a.length-1)=="/"},getBaseName:function(a){var b=a.split("/");return b[b.length-1]},sendChangeEvent:function(a){this.publish("change",[a,this.get(a)])},getDirName:function(a){return a.replace(/\/[^\/]*$/,"")},update:function(a,b){var c=this.get(a);e.extend(c,b),this.set(a,c)},set:function(a,b,c){var d=e.clone(b);c=c||function(){};var f=this;if(f.isDirectory(a)){f.tree[a]=[],f.id2index[a]={};if(!d.length)return c();var g=e.after(d.length,function(){f.sendChangeEvent(a),c()});for(var h=0;h<d.length;h++)f.id2index[a][d[h].id]=h,f.set(a+d[h].id,d[h],g)}else{var i;a===""?(i="",f.id2index[""]={"":0},f.tree[""]=[]):i=f.getDirName(a)+"/";var j=f.getBaseName(a);if(f.tree[i]===null||f.id2index[i]===null)return c("no base point");var k=f.id2index[i][j];if(k===null)return c("no base point");e.each(f.tree,function(b,c){c.indexOf(a+"/")===0&&delete f.tree[c]});var l=d.children;delete d.children;var m=function(){f.formatItem(a,d,function(b,d){f.tree[i][k]=d,f.sendChangeEvent(a),c()})};if(e.isFunction(l))f.childrenFunctions[a]=l;else if(e.isArray(l)){f.set(a+"/",l,function(a){if(a)return c(a);m()});return}m()}},insert:function(a,b,c,d){if(this.isDirectory(a)){var e=this.get(a)||[];this.set(a,e.slice(0,b.skip).concat(c,e.slice(b.skip+c.length,e.length)))}},formatItem:function(a,b,c){c(null,b)},prefetchAll:function(){var a=this;a.subscribe("change",function(b,c){var d=c[0];!a.isDirectory(d)&&a.childrenFunctions[d]&&a.moveTo("preload",d+"/")})}});return c.mixin(g.prototype),d.mixin(g.prototype),g}(Joshfire.loadModule("joshfire/main"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/mixins/pubsub"),Joshfire.loadModule("joshfire/mixins/state"),Joshfire.loadModule("joshfire/vendor/underscore"),Joshfire.loadModule("joshfire/vendor/json2"))},Joshfire.definedModules["joshfire/utils/delayedswitch"]=function(){return function(a){return a({__constructor:function(a,b,c){this._on=a,this._off=b,this.delayON=c,this.timer=!1},on:function(){if(!this.delayON)this._on&&this._on();else if(!this.timer){var a=this;this.timer=setTimeout(function(){a.timer=!1,a._on&&a._on()},this.delayON)}},off:function(){this.timer&&(clearTimeout(this.timer),this.timer=!1),this._off&&this._off()},reset:function(){this.off(),this.on()}})}(Joshfire.loadModule("joshfire/class"))},Joshfire.definedModules["joshfire/uielement"]=function(){return function(a,b,c,d,e,f){var g=b({getDefaultOptions:function(){return{hideDelay:0,autoShow:!0,showOnFocus:!0,hideOnBlur:!1,innerTemplate:"<%= htmlInner %>",innerHtmlId:!1,htmlId:!1,loadingTemplate:"Loading...",template:'<div style="display:none;" class="josh-type-<%= type %> josh-id-<%= id %> <%= htmlClass %>" id="<%= htmlId %>" data-josh-ui-path="<%= path %>"><%= htmlOuter %></div>',autoRefresh:!0,autoInsert:!0,forceDataPathRefresh:!1}},__constructor:function(a,b,c){var d=this;d.app=a,d.path=b,d.id=b.substring(1).replace(/\//g,"_",b),d.options=f.extend(d.getDefaultOptions(),c||{}),d.htmlClass=d.options.htmlClass||"",d.htmlId=d.getHtmlId(),d.innerHtmlId=d.getInnerHtmlId(),d.htmlEl=!1,d.innerHtmlEl=!1,d.parentEl=!1,d.parentUi=!1,d.hasFocus=!1,d.nextShowHide=!1,d.children=[],d.showHideSwitch=new e(function(){d.processShowHide()},null,d.options.hideDelay),f.each(d.options,function(a,b){if(b.substring(0,2)=="on"&&typeof a=="function"){var c=b.charAt(2).toLowerCase()+b.substring(3);d.subscribe(c,function(b,c,e){a(d,b,c,e)})}}),d.subscribe("state",function(a,b){d.checkFresh()}),d.init(),d.data||(d.data=!1,d.dataPath=!1),d.publish("afterInit")},init:function(){},setup:function(a){var b=this;b.options.uiDataMaster&&b.app.ui.fetch(b.options.uiDataMaster,!1,function(){var a=b.app.ui.element(b.options.uiDataMaster);a.subscribe("select",function(c,d){if(!d.length||!d[0].length||!a.dataPath)return;var e=a.dataPath+d[0];b.setDataPath(e)})}),b.options.uiDataSync&&b.app.ui.fetch(b.options.uiDataSync,!1,function(){var a=b.app.ui.element(b.options.uiDataSync);a.subscribe("data",function(a,c){c.length&&b.setData(c[0])})}),typeof b.options.dataPath=="string"&&b.setDataPath(b.options.dataPath),a()},setDataPath:function(a){var b=this;if(b.dataPath!=a||b.options.forceDataPathRefresh)b.setLoading(!0),b.setState("dataPath",a),b.dataPath=a,b.app.data.fetch(a,!1,function(c,d){if(b.dataPath!=a)return;b.setLoading(!1);if(c)return;b.setData(d),b.dataBound||b.bindToDataPath()})},bindToDataPath:function(){var a=this;a.dataBound=!0,a.app.data.subscribe("change",function(b,c){a.dataPath==c[0]&&a.setData(c[1])})},setLoading:function(a){this.setState("loading",a),a&&this.htmlEl&&this.options.loadingTemplate&&!this.children.length&&(this.htmlEl.innerHTML=this.template(this.options.loadingTemplate),this.htmlIsLoader=!0)},focus:function(){var a=this;a.publish("beforeFocus",null,!0);if(!a.hasFocus&&a.options.showOnFocus===!0){var b=this.path;for(var c=0;c<a.path.split("/").length-1;c++)a.app.ui.resolveMoves(b,"up",!1,function(b,c){a.app.ui.element(c).show()});a.show()}this.app.ui.setState("focus",this.path),this.hasFocus=!0,this.publish("afterFocus")},blur:function(){this.publish("beforeBlur",null,!0),this.options.hideOnBlur===!0&&this.hideDelayed(),this.hasFocus=!1,this.publish("afterBlur")},template:function(a){return this._=f,f.isFunction(a)?a(this):f.template(a,this)},show:function(){},hide:function(){},hasHtmlClass:function(a){if(!a||typeof a!="string")return;return(" "+this.htmlEl.className+" ").indexOf(" "+a+" ")!=-1},addHtmlClass:function(a){if(!a||typeof a!="string")return;this.hasHtmlClass(a)||(this.htmlEl.className+=" "+a)},removeHtmlClass:function(a){if(!a||typeof a!="string")return;this.htmlEl.className=(" "+this.htmlEl.className+" ").split(" "+a+" ").join(" ").slice(1,-1)},toggleHtmlClass:function(a){if(!a||typeof a!="string")return;this.hasHtmlClass(a)?this.removeHtmlClass(a):this.addHtmlClass(a)},processShowHide:function(){this.nextShowHide=="show"?this.show():this.hide()},showDelayed:function(){this.nextShowHide="show",this.showHideSwitch.reset()},hideDelayed:function(){this.nextShowHide="hide",this.showHideSwitch.reset()},insertInParent:function(){this.parentUi&&this.parentUi.children.push(this)},insert:function(a,b){var c=this;c.options.autoRefresh&&c.subscribe("data",function(){c.refresh()}),this.publish("beforeInsert",[a],!0),this.parentUi=!1,this.parentInnerHtmlEl=!1,a?a.app&&a.options?(this.parentUi=a,a.innerHtmlEl&&(this.parentInnerHtmlEl=a.innerHtmlEl)):this.parentInnerHtmlEl=a:this.path.length&&(this.parentUi=this.app.ui.element(this.app.ui.getDirName(this.path)),this.parentInnerHtmlEl=this.parentUi.innerHtmlEl),this.insertInParent(),this.setState("inserted",!0),this.options.autoShow&&this.show(),this.publish("afterInsert"),this.insertChildren(!1,b)},insertChildren:function(a,b){var c=this;b||(b=function(){}),c.app.ui.fetch(c.path+"/",!1,function(d,e){if(!e||!e.length)return b(d);var g=f.after(e.length,function(){b()});for(var h=0;h<e.length;h++)a||e[h].element.options.autoInsert?e[h].element.insert(c,g):g();return!0})},refresh:function(a){if(!this.getState("inserted"))return;this.htmlIsLoader||this.children.length==0?(this.htmlInner=this.getInnerHtml(),this.htmlEl.innerHTML=this.template(this.options.innerTemplate),this.htmlIsLoader=!1):this.innerHtmlEl.innerHTML=this.getInnerHtml(),this.publish("afterRefresh"),a&&a()},getHtmlId:function(){return this.options.htmlId?this.options.htmlId:this.app.id+"__"+this.id.toString().replace(/_/g,"__")},getInnerHtmlId:function(){return this.options.innerHtmlId?this.options.innerHtmlId:this.getHtmlId()},checkFresh:function(){this.isFresh()?(this.setState("fresh",!0),this.publish("fresh")):this.setState("fresh",!1),this.parentUi&&this.parentUi.checkFresh()},isFresh:function(){if(!this.getState("loading")){for(var a=0,b=this.children.length;a<b;a++)if(!this.children[a].isFresh())return!1;return!0}return!1},getHtml:function(){return this.htmlInner=this.getInnerHtml(),this.htmlOuter=this.template(this.options.innerTemplate),this.template(this.options.template)},getFreshHtml:function(a){var b=this;if(this.isFresh())a(null,this.getHtml());else var c=this.subscribe("fresh",function(d,e){b.unsubscribe(c),a(null,b.getHtml())})},getInnerHtml:function(){return""},setData:function(a){this.data=a,this.publish("data",[a]),this.setLoading(!1)}});return c.mixin(g.prototype),d.mixin(g.prototype),g}(Joshfire.loadModule("joshfire/main"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/mixins/pubsub"),Joshfire.loadModule("joshfire/mixins/state"),Joshfire.loadModule("joshfire/utils/delayedswitch"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/adapters/ios/uielement"]=function(){return function(a,b,c){var d=function(a){return document.getElementById(a)},e="block";return b(a,{getDefaultOptions:function(){return c.extend(this.__super(),{})},remove:function(){$("#"+this.htmlId).remove()},insertInParent:function(a){this.__super(),d(this.htmlId)||$(this.parentInnerHtmlEl).append(this.getHtml()),this.htmlEl=d(this.htmlId),this.innerHtmlEl=d(this.innerHtmlId)},refresh:function(a){(!d(this.htmlId)||!d(this.htmlId).id)&&this.options.autoInsert===!0&&this.insert(this.parentEl),this.__super(a)},show:function(){this.publish("beforeShow",null,!0),this._show(),this.publish
("afterShow"),this.showHideSwitch.off()},hide:function(){this.publish("beforeHide",null,!0),this._hide(),this.publish("afterHide"),this.showHideSwitch.off()},_show:function(){if(!d(this.htmlId))return;e=d(this.htmlId).style.display,d(this.htmlId).style.display="block"},_hide:function(){if(!d(this.htmlId))return;e=d(this.htmlId).style.display,d(this.htmlId).style.display="none"}})}(Joshfire.loadModule("joshfire/uielement"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/vendor/iscroll"]=function(){return function(){var a=Math,b=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",c="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,d="ontouchstart"in window,e=b+"Transform"in document.documentElement.style,f=/android/gi.test(navigator.appVersion),g=/iphone|ipad/gi.test(navigator.appVersion),h=/playbook/gi.test(navigator.appVersion),j=g||h,k=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),m=function(){return window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),n="onorientationchange"in window?"orientationchange":"resize",o=d?"touchstart":"mousedown",p=d?"touchmove":"mousemove",q=d?"touchend":"mouseup",r=d?"touchcancel":"mouseup",s=b=="Moz"?"DOMMouseScroll":"mousewheel",t="translate"+(c?"3d(":"("),u=c?",0)":")",v=function(a,h){var i=this,k=document,l;i.wrapper=typeof a=="object"?a:k.getElementById(a),i.wrapper.style.overflow="hidden",i.scroller=i.wrapper.children[0],i.options={hScroll:!0,vScroll:!0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:f,hideScrollbar:g,fadeScrollbar:g&&c,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){var b=a.explicitOriginalTarget?a.explicitOriginalTarget.nodeName.toLowerCase():a.target?a.target.nodeName.toLowerCase():"";b!="select"&&b!="option"&&b!="input"&&b!="textarea"&&a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(l in h)i.options[l]=h[l];i.options.useTransform=e?i.options.useTransform:!1,i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar,i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar,i.options.zoom=i.options.useTransform&&i.options.zoom,i.options.useTransition=j&&i.options.useTransition,i.scroller.style[b+"TransitionProperty"]=i.options.useTransform?"-"+b.toLowerCase()+"-transform":"top left",i.scroller.style[b+"TransitionDuration"]="0",i.scroller.style[b+"TransformOrigin"]="0 0",i.options.useTransition&&(i.scroller.style[b+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"),i.options.useTransform?i.scroller.style[b+"Transform"]=t+"0,0"+u:i.scroller.style.cssText+=";position:absolute;top:0;left:0",i.options.useTransition&&(i.options.fixedScrollbar=!0),i.refresh(),i._bind(n,window),i._bind(o),d||(i._bind("mouseout",i.wrapper),i._bind(s)),i.options.checkDOMChanges&&(i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500))};return v.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){var b=this;switch(a.type){case o:if(!d&&a.button!==0)return;b._start(a);break;case p:b._move(a);break;case q:case r:b._end(a);break;case n:b._resize();break;case s:b._wheel(a);break;case"mouseout":b._mouseout(a);break;case"webkitTransitionEnd":b._transitionEnd(a)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(c){var d=this,f=document,g;if(!d[c+"Scrollbar"]){d[c+"ScrollbarWrapper"]&&(e&&(d[c+"ScrollbarIndicator"].style[b+"Transform"]=""),d[c+"ScrollbarWrapper"].parentNode&&d[c+"ScrollbarWrapper"].parentNode.removeChild(d[c+"ScrollbarWrapper"]),d[c+"ScrollbarWrapper"]=null,d[c+"ScrollbarIndicator"]=null);return}d[c+"ScrollbarWrapper"]||(g=f.createElement("div"),d.options.scrollbarClass?g.className=d.options.scrollbarClass+c.toUpperCase():g.style.cssText="position:absolute;z-index:100;"+(c=="h"?"height:7px;bottom:1px;left:2px;right:"+(d.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(d.hScrollbar?"7":"2")+"px;top:2px;right:1px"),g.style.cssText+=";pointer-events:none;-"+b+"-transition-property:opacity;-"+b+"-transition-duration:"+(d.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(d.options.hideScrollbar?"0":"1"),d.wrapper.appendChild(g),d[c+"ScrollbarWrapper"]=g,g=f.createElement("div"),d.options.scrollbarClass||(g.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);-"+b+"-background-clip:padding-box;-"+b+"-box-sizing:border-box;"+(c=="h"?"height:100%":"width:100%")+";-"+b+"-border-radius:3px;border-radius:3px"),g.style.cssText+=";pointer-events:none;-"+b+"-transition-property:-"+b+"-transform;-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);-"+b+"-transition-duration:0;-"+b+"-transform:"+t+"0,0"+u,d.options.useTransition&&(g.style.cssText+=";-"+b+"-transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),d[c+"ScrollbarWrapper"].appendChild(g),d[c+"ScrollbarIndicator"]=g),c=="h"?(d.hScrollbarSize=d.hScrollbarWrapper.clientWidth,d.hScrollbarIndicatorSize=a.max(a.round(d.hScrollbarSize*d.hScrollbarSize/d.scrollerW),8),d.hScrollbarIndicator.style.width=d.hScrollbarIndicatorSize+"px",d.hScrollbarMaxScroll=d.hScrollbarSize-d.hScrollbarIndicatorSize,d.hScrollbarProp=d.hScrollbarMaxScroll/d.maxScrollX):(d.vScrollbarSize=d.vScrollbarWrapper.clientHeight,d.vScrollbarIndicatorSize=a.max(a.round(d.vScrollbarSize*d.vScrollbarSize/d.scrollerH),8),d.vScrollbarIndicator.style.height=d.vScrollbarIndicatorSize+"px",d.vScrollbarMaxScroll=d.vScrollbarSize-d.vScrollbarIndicatorSize,d.vScrollbarProp=d.vScrollbarMaxScroll/d.maxScrollY),d._scrollbarPos(c,!0)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},f?200:0)},_pos:function(c,d){c=this.hScroll?c:0,d=this.vScroll?d:0,this.options.useTransform?this.scroller.style[b+"Transform"]=t+c+"px,"+d+"px"+u+" scale("+this.scale+")":(c=a.round(c),d=a.round(d),this.scroller.style.left=c+"px",this.scroller.style.top=d+"px"),this.x=c,this.y=d,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(c,d){var e=this,f=c=="h"?e.x:e.y,g;if(!e[c+"Scrollbar"])return;f=e[c+"ScrollbarProp"]*f,f<0?(e.options.fixedScrollbar||(g=e[c+"ScrollbarIndicatorSize"]+a.round(f*3),g<8&&(g=8),e[c+"ScrollbarIndicator"].style[c=="h"?"width":"height"]=g+"px"),f=0):f>e[c+"ScrollbarMaxScroll"]&&(e.options.fixedScrollbar?f=e[c+"ScrollbarMaxScroll"]:(g=e[c+"ScrollbarIndicatorSize"]-a.round((f-e[c+"ScrollbarMaxScroll"])*3),g<8&&(g=8),e[c+"ScrollbarIndicator"].style[c=="h"?"width":"height"]=g+"px",f=e[c+"ScrollbarMaxScroll"]+(e[c+"ScrollbarIndicatorSize"]-g))),e[c+"ScrollbarWrapper"].style[b+"TransitionDelay"]="0",e[c+"ScrollbarWrapper"].style.opacity=d&&e.options.hideScrollbar?"0":"1",e[c+"ScrollbarIndicator"].style[b+"Transform"]=t+(c=="h"?f+"px,0":"0,"+f+"px")+u},_start:function(c){var e=this,f=d?c.touches[0]:c,g,h,i,j,k;if(!e.enabled)return;e.options.onBeforeScrollStart&&e.options.onBeforeScrollStart.call(e,c),(e.options.useTransition||e.options.zoom)&&e._transitionTime(0),e.moved=!1,e.animating=!1,e.zoomed=!1,e.distX=0,e.distY=0,e.absDistX=0,e.absDistY=0,e.dirX=0,e.dirY=0,e.options.zoom&&d&&c.touches.length>1&&(j=a.abs(c.touches[0].pageX-c.touches[1].pageX),k=a.abs(c.touches[0].pageY-c.touches[1].pageY),e.touchesDistStart=a.sqrt(j*j+k*k),e.originX=a.abs(c.touches[0].pageX+c.touches[1].pageX-e.wrapperOffsetLeft*2)/2-e.x,e.originY=a.abs(c.touches[0].pageY+c.touches[1].pageY-e.wrapperOffsetTop*2)/2-e.y,e.options.onZoomStart&&e.options.onZoomStart.call(e,c));if(e.options.momentum){e.options.useTransform?(g=getComputedStyle(e.scroller,null)[b+"Transform"].replace(/[^0-9-.,]/g,"").split(","),h=g[4]*1,i=g[5]*1):(h=getComputedStyle(e.scroller,null).left.replace(/[^0-9-]/g,"")*1,i=getComputedStyle(e.scroller,null).top.replace(/[^0-9-]/g,"")*1);if(h!=e.x||i!=e.y)e.options.useTransition?e._unbind("webkitTransitionEnd"):m(e.aniTime),e.steps=[],e._pos(h,i)}e.absStartX=e.x,e.absStartY=e.y,e.startX=e.x,e.startY=e.y,e.pointX=f.pageX,e.pointY=f.pageY,e.startTime=c.timeStamp||(new Date).getTime(),e.options.onScrollStart&&e.options.onScrollStart.call(e,c),e._bind(p),e._bind(q),e._bind(r)},_move:function(c){var e=this,f=d?c.touches[0]:c,g=f.pageX-e.pointX,h=f.pageY-e.pointY,i=e.x+g,j=e.y+h,k,l,m,n=c.timeStamp||(new Date).getTime();e.options.onBeforeScrollMove&&e.options.onBeforeScrollMove.call(e,c);if(e.options.zoom&&d&&c.touches.length>1){k=a.abs(c.touches[0].pageX-c.touches[1].pageX),l=a.abs(c.touches[0].pageY-c.touches[1].pageY),e.touchesDist=a.sqrt(k*k+l*l),e.zoomed=!0,m=1/e.touchesDistStart*e.touchesDist*this.scale,m<e.options.zoomMin?m=.5*e.options.zoomMin*Math.pow(2,m/e.options.zoomMin):m>e.options.zoomMax&&(m=2*e.options.zoomMax*Math.pow(.5,e.options.zoomMax/m)),e.lastScale=m/this.scale,i=this.originX-this.originX*e.lastScale+this.x,j=this.originY-this.originY*e.lastScale+this.y,this.scroller.style[b+"Transform"]=t+i+"px,"+j+"px"+u+" scale("+m+")",e.options.onZoom&&e.options.onZoom.call(e,c);return}e.pointX=f.pageX,e.pointY=f.pageY;if(i>0||i<e.maxScrollX)i=e.options.bounce?e.x+g/2:i>=0||e.maxScrollX>=0?0:e.maxScrollX;if(j>e.minScrollY||j<e.maxScrollY)j=e.options.bounce?e.y+h/2:j>=e.minScrollY||e.maxScrollY>=0?e.minScrollY:e.maxScrollY;if(e.absDistX<6&&e.absDistY<6){e.distX+=g,e.distY+=h,e.absDistX=a.abs(e.distX),e.absDistY=a.abs(e.distY);return}e.options.lockDirection&&(e.absDistX>e.absDistY+5?(j=e.y,h=0):e.absDistY>e.absDistX+5&&(i=e.x,g=0)),e.moved=!0,e._pos(i,j),e.dirX=g>0?-1:g<0?1:0,e.dirY=h>0?-1:h<0?1:0,n-e.startTime>300&&(e.startTime=n,e.startX=e.x,e.startY=e.y),e.options.onScrollMove&&e.options.onScrollMove.call(e,c)},_end:function(c){if(d&&c.touches.length!=0)return;var e=this,f=d?c.changedTouches[0]:c,g,h,i={dist:0,time:0},j={dist:0,time:0},k=(c.timeStamp||(new Date).getTime())-e.startTime,l=e.x,m=e.y,n,o,s,v;e._unbind(p),e._unbind(q),e._unbind(r),e.options.onBeforeScrollEnd&&e.options.onBeforeScrollEnd.call(e,c);if(e.zoomed){v=e.scale*e.lastScale,v=Math.max(e.options.zoomMin,v),v=Math.min(e.options.zoomMax,v),e.lastScale=v/e.scale,e.scale=v,e.x=e.originX-e.originX*e.lastScale+e.x,e.y=e.originY-e.originY*e.lastScale+e.y,e.scroller.style[b+"TransitionDuration"]="200ms",e.scroller.style[b+"Transform"]=t+e.x+"px,"+e.y+"px"+u+" scale("+e.scale+")",e.zoomed=!1,e.refresh(),e.options.onZoomEnd&&e.options.onZoomEnd.call(e,c);return}if(!e.moved){d&&(e.doubleTapTimer&&e.options.zoom?(clearTimeout(e.doubleTapTimer),e.doubleTapTimer=null,e.options.onZoomStart&&e.options.onZoomStart.call(e,c),e.zoom(e.pointX,e.pointY,e.scale==1?e.options.doubleTapZoom:1),e.options.onZoomEnd&&setTimeout(function(){e.options.onZoomEnd.call(e,c)},200)):e.doubleTapTimer=setTimeout(function(){e.doubleTapTimer=null,g=f.target;while(g.nodeType!=1)g=g.parentNode;g.tagName!="SELECT"&&g.tagName!="INPUT"&&g.tagName!="TEXTAREA"&&(h=document.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!0,c.view,1,f.screenX,f.screenY,f.clientX,f.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null),h._fake=!0,g.dispatchEvent(h))},e.options.zoom?250:0)),e._resetPos(200),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,c);return}if(k<300&&e.options.momentum){i=l?e._momentum(l-e.startX,k,-e.x,e.scrollerW-e.wrapperW+e.x,e.options.bounce?e.wrapperW:0):i,j=m?e._momentum(m-e.startY,k,-e.y,e.maxScrollY<0?e.scrollerH-e.wrapperH+e.y-e.minScrollY:0,e.options.bounce?e.wrapperH:0):j,l=e.x+i.dist,m=e.y+j.dist;if(e.x>0&&l>0||e.x<e.maxScrollX&&l<e.maxScrollX)i={dist:0,time:0};if(e.y>e.minScrollY&&m>e.minScrollY||e.y<e.maxScrollY&&m<e.maxScrollY)j={dist:0,time:0}}if(i.dist||j.dist){s=a.max(a.max(i.time,j.time),10),e.options.snap&&(n=l-e.absStartX,o=m-e.absStartY,a.abs(n)<e.options.snapThreshold&&a.abs(o)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(snap=e._snap(l,m),l=snap.x,m=snap.y,s=a.max(snap.time,s))),e.scrollTo(l,m,s),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,c);return}if(e.options.snap){n=l-e.absStartX,o=m-e.absStartY,a.abs(n)<e.options.snapThreshold&&a.abs(o)<e.options.snapThreshold?e.scrollTo(e.absStartX,e.absStartY,200):(snap=e._snap(e.x,e.y),(snap.x!=e.x||snap.y!=e.y)&&e.scrollTo(snap.x,snap.y,snap.time)),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,c);return}e._resetPos(200),e.options.onTouchEnd&&e.options.onTouchEnd.call(e,c)},_resetPos:function(a){var c=this,d=c.x>=0?0:c.x<c.maxScrollX?c.maxScrollX:c.x,e=c.y>=c.minScrollY||c.maxScrollY>0?c.minScrollY:c.y<c.maxScrollY?c.maxScrollY:c.y;if(d==c.x&&e==c.y){c.moved&&(c.moved=!1,c.options.onScrollEnd&&c.options.onScrollEnd.call(c)),c.hScrollbar&&c.options.hideScrollbar&&(b=="webkit"&&(c.hScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),c.hScrollbarWrapper.style.opacity="0"),c.vScrollbar&&c.options.hideScrollbar&&(b=="webkit"&&(c.vScrollbarWrapper.style[b+"TransitionDelay"]="300ms"),c.vScrollbarWrapper.style.opacity="0");return}c.scrollTo(d,e,a||0)},_wheel:function(a){var b=this,c,d,e,f,g;"wheelDeltaX"in a?(c=a.wheelDeltaX/12,d=a.wheelDeltaY/12):"detail"in a?c=d=-a.detail*3:c=d=-a.wheelDelta;if(b.options.wheelAction=="zoom"){g=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),g<b.options.zoomMin&&(g=b.options.zoomMin),g>b.options.zoomMax&&(g=b.options.zoomMax),g!=b.scale&&(!b.wheelZoomCount&&b.options.onZoomStart&&b.options.onZoomStart.call(b,a),b.wheelZoomCount++,b.zoom(a.pageX,a.pageY,g,400),setTimeout(function(){b.wheelZoomCount--,!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,a)},400));return}e=b.x+c,f=b.y+d,e>0?e=0:e<b.maxScrollX&&(e=b.maxScrollX),f>b.minScrollY?f=b.minScrollY:f<b.maxScrollY&&(f=b.maxScrollY),b.scrollTo(e,f,0)},_mouseout:function(a){var b=a.relatedTarget;if(!b){this._end(a);return}while(b=b.parentNode)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){var b=this;if(a.target!=b.scroller)return;b._unbind("webkitTransitionEnd"),b._startAni()},_startAni:function(){var b=this,c=b.x,d=b.y,e=(new Date).getTime(),f,g;if(b.animating)return;if(!b.steps.length){b._resetPos(400);return}f=b.steps.shift(),f.x==c&&f.y==d&&(f.time=0),b.animating=!0,b.moved=!0;if(b.options.useTransition){b._transitionTime(f.time),b._pos(f.x,f.y),b.animating=!1,f.time?b._bind("webkitTransitionEnd"):b._resetPos(0);return}(function h(){var i=(new Date).getTime(),j,l;if(i>=e+f.time){b._pos(f.x,f.y),b.animating=!1,b.options.onAnimationEnd&&b.options.onAnimationEnd.call(b),b._startAni();return}i=(i-e)/f.time-1,g=a.sqrt(1-i*i),j=(f.x-c)*g+c,l=(f.y-d)*g+d,b._pos(j,l),b.animating&&(b.aniTime=k(h))})()},_transitionTime:function(a){a+="ms",this.scroller.style[b+"TransitionDuration"]=a,this.hScrollbar&&(this.hScrollbarIndicator.style[b+"TransitionDuration"]=a),this.vScrollbar&&(this.vScrollbarIndicator.style[b+"TransitionDuration"]=a)},_momentum:function(b,c,d,e,f){var g=6e-4,h=a.abs(b)/c,i=h*h/(2*g),j=0,k=0;return b>0&&i>d?(k=f/(6/(i/h*g)),d+=k,h=h*d/i,i=d):b<0&&i>e&&(k=f/(6/(i/h*g)),e+=k,h=h*e/i,i=e),i*=b<0?-1:1,j=h/g,{dist:i,time:a.round(j)}},_offset:function(a){var b=-a.offsetLeft,c=-a.offsetTop;while(a=a.offsetParent)b-=a.offsetLeft,c-=a.offsetTop;return a!=this.wrapper&&(b*=this.scale,c*=this.scale),{left:b,top:c}},_snap:function(b,c){var d=this,e,f,g,h,i,j;g=d.pagesX.length-1;for(e=0,f=d.pagesX.length;e<f;e++)if(b>=d.pagesX[e]){g=e;break}g==d.currPageX&&g>0&&d.dirX<0&&g--,b=d.pagesX[g],i=a.abs(b-d.pagesX[d.currPageX]),i=i?a.abs(d.x-b)/i*500:0,d.currPageX=g,g=d.pagesY.length-1;for(e=0;e<g;e++)if(c>=d.pagesY[e]){g=e;break}return g==d.currPageY&&g>0&&d.dirY<0&&g--,c=d.pagesY[g],j=a.abs(c-d.pagesY[d.currPageY]),j=j?a.abs(d.y-c)/j*500:0,d.currPageY=g,h=a.round(a.max(i,j))||200,{x:b,y:c,time:h}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){var a=this;a.scroller.style[b+"Transform"]="",a.hScrollbar=!1,a.vScrollbar=!1,a._scrollbar("h"),a._scrollbar("v"),a._unbind(n,window),a._unbind(o),a._unbind(p),a._unbind(q),a._unbind(r),a.options.hasTouch&&(a._unbind("mouseout",a.wrapper),a._unbind(s)),a.options.useTransition&&a._unbind("webkitTransitionEnd"),a.options.checkDOMChanges&&clearInterval(a.checkDOMTime),a.options.onDestroy&&a.options.onDestroy.call(a)},refresh:function(){var c=this,d,e=0,f=0;c.scale<c.options.zoomMin&&(c.scale=c.options.zoomMin),c.wrapperW=c.wrapper.clientWidth||1,c.wrapperH=c.wrapper.clientHeight||1,c.minScrollY=-c.options.topOffset||0,c.scrollerW=a.round(c.scroller.offsetWidth*c.scale),c.scrollerH=a.round((c.scroller.offsetHeight+c.minScrollY)*c.scale),c.maxScrollX=c.wrapperW-c.scrollerW,c.maxScrollY=c.wrapperH-c.scrollerH+c.minScrollY,c.dirX=0,c.dirY=0,c.options.onRefresh&&c.options.onRefresh.call(c),c.hScroll=c.options.hScroll&&c.maxScrollX<0,c.vScroll=c.options.vScroll&&(!c.options.bounceLock&&!c.hScroll||c.scrollerH>c.wrapperH),c.hScrollbar=c.hScroll&&c.options.hScrollbar,c.vScrollbar=c.vScroll&&c.options.vScrollbar&&c.scrollerH>c.wrapperH,d=c._offset(c.wrapper),c.wrapperOffsetLeft=-d.left,c.wrapperOffsetTop=-d.top;if(typeof c.options.snap=="string"){c.pagesX=[],c.pagesY=[],els=c.scroller.querySelectorAll(c.options.snap);for(i=0,l=els.length;i<l;i++)e=c._offset(els[i]),e.left+=c.wrapperOffsetLeft,e.top+=c.wrapperOffsetTop,c.pagesX[i]=e.left<c.maxScrollX?c.maxScrollX:e.left*c.scale,c.pagesY[i]=e.top<c.maxScrollY?c.maxScrollY:e.top*c.scale}else if(c.options.snap){c.pagesX=[];while(e>=c.maxScrollX)c.pagesX[f]=e,e-=c.wrapperW,f++;c.maxScrollX%c.wrapperW&&(c.pagesX[c.pagesX.length]=c.maxScrollX-c.pagesX[c.pagesX.length-1]+c.pagesX[c.pagesX.length-1]),e=0,f=0,c.pagesY=[];while(e>=c.maxScrollY)c.pagesY[f]=e,e-=c.wrapperH,f++;c.maxScrollY%c.wrapperH&&(c.pagesY[c.pagesY.length]=c.maxScrollY-c.pagesY[c.pagesY.length-1]+c.pagesY[c.pagesY.length-1])}c._scrollbar("h"),c._scrollbar("v"),c.zoomed||(c.scroller.style[b+"TransitionDuration"]="0",c._resetPos(200))},scrollTo:function(a,b,c,d){var e=this,f=a,g,h;e.stop(),f.length||(f=[{x:a,y:b,time:c,relative:d}]);for(g=0,h=f.length;g<h;g++)f[g].relative&&(f[g].x=e.x-f[g].x,f[g].y=e.y-f[g].y),e.steps.push({x:f[g].x,y:f[g].y,time:f[g].time||0});e._startAni()},scrollToElement:function(b,c){var d=this,e;b=b.nodeType?b:d.scroller.querySelector(b);if(!b)return;e=d._offset(b),e.left+=d.wrapperOffsetLeft,e.top+=d.wrapperOffsetTop,e.left=e.left>0?0:e.left<d.maxScrollX?d.maxScrollX:e.left,e.top=e.top>d.minScrollY?d.minScrollY:e.top<d.maxScrollY?d.maxScrollY:e.top,c=c===undefined?a.max(a.abs(e.left)*2,a.abs(e.top)*2):c,d.scrollTo(e.left,e.top,c)},scrollToPage:function(a,b,c){var d=this,e,f;d.options.snap?(a=a=="next"?d.currPageX+1:a=="prev"?d.currPageX-1:a,b=b=="next"?d.currPageY+1:b=="prev"?d.currPageY-1:b,a=a<0?0:a>d.pagesX.length-1?d.pagesX.length-1:a,b=b<0?0:b>d.pagesY.length-1?d.pagesY.length-1:b,d.currPageX=a,d.currPageY=b,e=d.pagesX[a],f=d.pagesY[b]):(e=-d.wrapperW*a,f=-d.wrapperH*b,e<d.maxScrollX&&(e=d.maxScrollX),f<d.maxScrollY&&(f=d.maxScrollY)),d.scrollTo(e,f,c||400)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(p),this._unbind(q),this._unbind(r)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind("webkitTransitionEnd"):m(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(a,c,d,e){var f=this,g=d/f.scale;if(!f.options.useTransform)return;f.zoomed=!0,e=e===undefined?200:e,a=a-f.wrapperOffsetLeft-f.x,c=c-f.wrapperOffsetTop-f.y,f.x=a-a*g+f.x,f.y=c-c*g+f.y,f.scale=d,f.refresh(),f.x=f.x>0?0:f.x<f.maxScrollX?f.maxScrollX:f.x,f.y=f.y>f.minScrollY?f.minScrollY:f.y<f.maxScrollY?f.maxScrollY:f.y,f.scroller.style[b+"TransitionDuration"]=e+"ms",f.scroller.style[b+"Transform"]=t+f.x+"px,"+f.y+"px"+u+" scale("+d+")",f.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},v}()},Joshfire.definedModules["joshfire/adapters/android/uielements/panel"]=function(){return function(a,b,c,d){return b(a,{type:"Panel",getDefaultOptions:function(){return d.extend(this.__super(),{scroller:!1})},init:function(){var a=this;a.__super(),a.scrollOptions=d.extend({},a.options.scrollOptions,{active:a.options.scroller||!1}),a.options.scrollBarClass&&(a.scrollOptions.scrollbarClass=a.options.scrollBarClass)},insertScroller:function(){var a=this;if(!a.scrollOptions||!a.getState("inserted"))return;this.hasScroller=!0,a.scrollOptions.active&&(a.iScroller&&a.iScroller.destroy(),a.iScroller=new c(a.htmlId,a.scrollOptions),document.addEventListener("orientationChanged",function(b){a.iScroller&&a.iScroller.refresh()}))},insert:function(a,b){var c=this;c.__super(a,b),c.scrollOptions.active&&(document.addEventListener("touchmove",function(a){a.preventDefault()},!1),c.subscribe("afterShow",function(){c.insertScroller()}))},getInnerHtml:function(){return this.options.content?this.options.content:this.data&&this.data.content?this.data.content:this.__super()},refresh:function(a){var b=this;b.scrollOptions.active&&setTimeout(function(){b.iScroller&&b.iScroller.refresh()},0);if(!this.children.length)return this.__super(a)}})}(Joshfire.loadModule("joshfire/adapters/ios/uielement"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/iscroll"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/adapters/ios/uielements/panel"]=function(){return function(a,b,c){return a}(Joshfire.loadModule("joshfire/adapters/android/uielements/panel"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/tree.ui"]=function(){return function(a,b,c,d,e){return b(c,{allowRootAccess:!0,setupQueue:[],formatItem:function(b,c,e){var f=this;this.setupQueue.push(b),d.isString(c.type)?a.require(["joshfire/uielements/"+c.type],function(a){c.element=new a(f.app,b,c),e(null,c)}):(c.element=new c.type(f.app,b,c),e(null,c))},setup:function(a){var b=this;b.__super(function(){b.setupElements(a)})},setupElements:function(a){var b=this,c=function(){if(!b.setupQueue.length)return a();var d=b.setupQueue.shift();b.element(d).setup(c)};c()},addRootElement:function(a){this.set("",{id:"root",type:"panel",autoShow:!0},a)},init:function(){var a=this;this.__super(),a.lastFocusedPath=null,a.subscribe("state",function(b,c){var d=c[0],e=c[1];if(d=="focus"){var f=a.element(e);e!=a.lastFocusedPath&&(a.lastFocusedPath&&a.element(a.lastFocusedPath).blur(),f.focus(),a.lastFocusedPath=e)}}),a.app.subscribe("input",function(b,c){a.lastFocusedPath&&a.element(a.lastFocusedPath).publish(b,c)})},set:function(a,b,c){var e=this;if(a=="/"&&!this.tree[""]&&!this.tree["/"]){if(d.isArray(b))return this.addRootElement(function(d){e.set(a,b,c)}),!0;a=""}return this.__super(a,b,c)},element:function(a){var b=this.get(a);return b?b.element:(console.error("Error retrieving ui element",a),!1)}})}(Joshfire.loadModule("joshfire/main"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/tree"),Joshfire.loadModule("joshfire/vendor/underscore"),Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"))},Joshfire.definedModules["joshfire/tree.data"]=function(){return function(a){return a}(Joshfire.loadModule("joshfire/tree"))},Joshfire.definedModules["joshfire/app"]=function(){return function(a,b,c,d,e,f,g){var h=b({id:"DefaultAppId",getDefaultOptions:function(){return{autoSetup:!0,uiTree:!1,inputs:[],dataTree:!1,autoInsert:!1}},__constructor:function(a){this.options=g.extend(this.getDefaultOptions(),a||{}),this.init(),this.options.autoSetup&&this.setupAll(function(a){})},init:function(){},setup:function(a){a()},setupAll:function(a){var b=this,c=function(c){b.publish("error",[c]),a(c)};b.setupDataTree(function(d){if(d)return c(d);b.setupUiTree(function(d){if(d)return c(d);b.setupInputs(function(d){if(d)return c(d);b.setup(function(d){if(d)return c(d);b.publish("ready"),a(null,!0)})})})})},setupUiTree:function(a){this.options.uiTree||this.uiTree?(this.ui=new c(this,"ui",{tree:this.options.uiTree||this.uiTree}),this.ui.setup(a)):this.options.uiClass||this.uiClass?(this.ui=new(this.options.uiClass||this.uiClass)(this,"ui"),this.ui.setup(a)):a(null)},setupDataTree:function(a){this.options.dataTree||this.dataTree?(this.data=new d(this,"data",{tree:this.options.dataTree||this.dataTree}),this.data.setup(a)):this.options.dataClass||this.dataClass?(this.data=new(this.options.dataClass||this.dataClass)(this,"data"),this.data.setup(a)):a(null)},setupInputs:function(b){var c=this;if(c.options.inputs.length===0)return b(null);var d=g.after(c.options.inputs.length,function(){b(null)});c.inputs={},g.each(c.options.inputs,function(b){var e=function(a){c.inputs[b]=new a(c,b),c.inputs[b].setup(d)};g.isString(b)?a.require(["joshfire/inputs/"+b],e):e(b)})}});return e.mixin(h.prototype),f.mixin(h.prototype),h}(Joshfire.loadModule("joshfire/main"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/tree.ui"),Joshfire.loadModule("joshfire/tree.data"),Joshfire.loadModule("joshfire/mixins/pubsub"),Joshfire.loadModule("joshfire/mixins/state"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/vendor/zepto"]=function(){return function(){(function(a){String.prototype.trim===a&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===a&&(Array.prototype.reduce=function(b){if(this===void 0||this===null)throw new TypeError;var c=Object(this),d=c.length>>>0,e=0,f;if(typeof b!="function")throw new TypeError;if(d==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)f=arguments[1];else do{if(e in c){f=c[e++];break}if(++e>=d)throw new TypeError}while(!0);while(e<d)e in c&&(f=b.call(a,f,c[e],e,c)),e++;return f})})();var a=function(){function n(a){return{}.toString.call(a)=="[object Function]"}function o(a){return a instanceof Object}function p(a){return a instanceof Array}function q(b){return b.filter(function(b){return b!==a&&b!==null})}function r(a){return[].concat.apply([],a)}function s(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})}function t(a){return a.filter(function(a,b,c){return c.indexOf(a)==b})}function u(a){return a in j?j[a]:j[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function v(a){var b,c;return i[a]||(b=h.createElement(a),h.body.insertAdjacentElement("beforeEnd",b),c=k(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),c=="none"&&(c="block"),i[a]=c),i[a]}function w(a){return m.innerHTML=(""+a).trim(),g.call(m.childNodes)}function x(a,b){return a=a||f,a.__proto__=x.prototype,a.selector=b||"",a}function y(b,c){if(!b)return x();if(c!==a)return y(c).find(b);if(n(b))return y(h).ready(b);if(b instanceof x)return b;var e;return p(b)?e=q(b):b instanceof Element||b===window||b===h?(e=[b],b=null):l.test(b)?e=w(b):b.nodeType&&b.nodeType==3?e=[b]:e=d(h,b),x(e,b)}function z(b,c){return c===a?y(b):y(b).filter(c)}function A(a,b,c,d){return n(b)?b.call(a,c,d):b}function C(a,b,c){var d=!a||a==3?b:b.parentNode;d.insertBefore(c,a?a==1?b.nextSibling:a==2?b:null:d.firstChild)}var a,b,c,d,e,f=[],g=f.slice,h=window.document,i={},j={},k=h.defaultView.getComputedStyle,l=/^\s*<[^>]+>/,m=h.createElement("div");y.extend=function(a,c){for(b in c)a[b]=c[b];return a},y.qsa=d=function(a,b){return b?g.call(a.querySelectorAll(b)):x()},y.isFunction=n,y.isObject=o,y.isArray=p,y.fn={forEach:f.forEach,map:f.map,reduce:f.reduce,push:f.push,indexOf:f.indexOf,concat:f.concat,ready:function(a){return(h.readyState=="complete"||h.readyState=="loaded")&&a(),h.addEventListener("DOMContentLoaded",a,!1),this},get:function(b){return b===a?this:this[b]},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode.removeChild(this)})},each:function(a){return this.forEach(function(b,c){a.call(b,c,b)}),this},filter:function(a){return y([].filter.call(this,function(b){return d(b.parentNode,a).indexOf(b)>=0}))},add:function(a,b){return y(t(this.concat(y(a,b))))},is:function(a){return this.length>0&&y(this[0]).filter(a).length>0},not:function(b){var c=[];if(n(b)&&b.call!==a)this.each(function(a){b.call(this,a)||c.push(this)});else{var d=g.call(typeof b=="string"?this.filter(b):b instanceof NodeList?b:y(b));g.call(this).forEach(function(a){d.indexOf(a)<0&&c.push(a)})}return y(c)},eq:function(a){return y(this[a])},first:function(){return y(this[0])},last:function(){return y(this[this.length-1])},find:function(a){var b;return this.length==1?b=d(this[0],a):b=r(this.map(function(b){return d(b,a)})),y(b)},closest:function(b,c){var e=this[0],f=d(c!==a?c:h,b);f.length===0&&(e=null);while(e&&e!==h&&f.indexOf(e)<0)e=e.parentNode;return y(e!==h&&e)},parents:function(a){var b=[],c=this;while(c.length>0)c=q(c.map(function(a){if((a=a.parentNode)&&a!==h&&b.indexOf(a)<0)return b.push(a),a}));return z(b,a)},parent:function(a){return z(t(q(this.pluck("parentNode"))),a)},children:function(a){return z(r(this.map(function(a){return g.call(a.children)})),a)},siblings:function(a){return z(r(this.map(function(a){return g.call(a.parentNode.children).filter(function(b){return b!==a})})),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return this.map(function(b){return b[a]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),k(this,"").getPropertyValue("display")=="none"&&(this.style.display=v(this.nodeName))})},replaceWith:function(a){return this.each(function(){var b=y(this),c=b.prev();b.remove(),c.after(a)})},hide:function(){return this.css("display","none")},toggle:function(){return this.css("display")=="none"?this.show():this.hide()},prev:function(){return y(this.pluck("previousElementSibling"))},next:function(){return y(this.pluck("nextElementSibling"))},html:function(b){return b===a?this.length>0?this[0].innerHTML:null:this.each(function(a){this.innerHTML=A(this,b,a,this.innerHTML)})},text:function(b){return b===a?this.length>0?this[0].innerText:null:this.each(function(){this.innerText=b})},attr:function(c,d){return typeof c=="string"&&d===a?this.length>0&&this[0].nodeName=="INPUT"&&this[0].type=="text"&&c=="value"?this.val():this.length>0?this[0].getAttribute(c)||(c in this[0]?this[0][c]:a):a:this.each(function(a){if(o(c))for(b in c)this.setAttribute(b,c[b]);else this.setAttribute(c,A(this,d,a,this.getAttribute(c)))})},removeAttr:function(a){return this.each(function(){this.removeAttribute(a)})},data:function(a,b){return this.attr("data-"+a,b)},val:function(b){return b===a?this.length>0?this[0].value:null:this.each(function(){this.value=b})},offset:function(){if(this.length==0)return null;var a=this[0].getBoundingClientRect();return{left:a.left+h.body.scrollLeft,top:a.top+h.body.scrollTop,width:a.width,height:a.height}},css:function(d,e){if(e===a&&typeof d=="string")return this[0].style[s(d)]||k(this[0],"").getPropertyValue(d);c="";for(b in d)c+=b+":"+d[b]+";";return typeof d=="string"&&(c=d+":"+e),this.each(function(){this.style.cssText+=";"+c})},index:function(a){return this.indexOf(y(a)[0])},hasClass:function(a){return u(a).test(this[0].className)},addClass:function(a){return this.each(function(b){e=[];var c=this.className,d=A(this,a,b,c);d.split(/\s+/g).forEach(function(a){y(this).hasClass(a)||e.push(a)},this),e.length&&(this.className+=(c?" ":"")+e.join(" "))})},removeClass:function(a){return this.each(function(b){e=this.className,A(this,a,b,e).split(/\s+/g).forEach(function(a){e=e.replace(u(a)," ")}),this.className=e.trim()})},toggleClass:function(b,c){return this.each(function(d){var e=this.className,f=A(this,b,d,e);c!==a&&!c||y(this).hasClass(f)?y(this).removeClass(f):y(this).addClass(f)})},submit:function(){return this.each(function(){try{this.submit();return}catch(a){}})}},["width","height"].forEach(function(a){y.fn[a]=function(){var b=this.offset();return b?b[a]:null}});var B=["prepend","after","before","append"];B.forEach(function(a,b){y.fn[a]=function(a){return typeof a!="object"&&(a=w(a)),this.each(function(c,d){if(a.length||a instanceof x){dom=a;for(var e=0;e<dom.length;e++){var f=dom[b<2?dom.length-e-1:e];C(b,d,f)}}else C(b,d,a)})}});var D=["append","prepend"
];return D.forEach(function(a){y.fn[a+"To"]=function(b){return typeof b!="object"&&(b=w(b)),b[a](this),this}}),x.prototype=y.fn,y}();return"$"in window||(window.$=a),function(a){function e(a){return a._zid||(a._zid=d++)}function f(a,b,d,f){b=g(b);if(b.ns)var i=h(b.ns);return(c[e(a)]||[]).filter(function(a){return a&&(!b.e||a.e==b.e)&&(!b.ns||i.test(a.ns))&&(!d||a.fn==d)&&(!f||a.sel==f)})}function g(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function h(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function i(b,d,f,h,i){var j=e(b),k=c[j]||(c[j]=[]);d.split(/\s/).forEach(function(c){var d=i||f,e=function(a){return d(a,a.data)},j=a.extend(g(c),{fn:f,proxy:e,sel:h,del:i,i:k.length});k.push(j),b.addEventListener(j.e,e,!1)})}function j(a,b,d,g){var h=e(a);(b||"").split(/\s/).forEach(function(b){f(a,b,d,g).forEach(function(b){delete c[h][b.i],a.removeEventListener(b.e,b.proxy,!1)})})}function l(b){var c=a.extend({originalEvent:b},b);return k.forEach(function(a){c[a]=function(){return b[a].apply(b,arguments)}}),c}var b=a.qsa,c={},d=1;a.event={add:i,remove:j},a.fn.bind=function(a,b){return this.each(function(){i(this,a,b)})},a.fn.unbind=function(a,b){return this.each(function(){j(this,a,b)})},a.fn.one=function(a,b){return this.each(function(){var c=this;i(this,a,function(){b(),j(c,a,arguments.callee)})})};var k=["preventDefault","stopImmediatePropagation","stopPropagation"];a.fn.delegate=function(c,d,e){return this.each(function(f,g){i(g,d,e,c,function(d,f){var h=d.target,i=b(g,c);h&&h!==g&&h!==document&&e.call(h,a.extend(l(d),{currentTarget:h,liveFired:g}),f)})})},a.fn.undelegate=function(a,b,c){return this.each(function(){j(this,b,c,a)})},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.trigger=function(a,b){return this.each(function(){var c=document.createEvent("Events");c.initEvent(a,!0,!0),c.data=b,this.dispatchEvent(c)})}}(a),function(a){function b(a){var a=a,b={},c=a.match(/(Android)\s+([\d.]+)/),d=a.match(/(iPhone\sOS)\s([\d_]+)/),e=a.match(/(iPad).*OS\s([\d_]+)/),f=a.match(/(webOS)\/([\d.]+)/),g=a.match(/(BlackBerry).*Version\/([\d.]+)/);return c&&(b.android=!0,b.version=c[2]),d&&(b.ios=!0,b.version=d[2].replace(/_/g,"."),b.iphone=!0),e&&(b.ios=!0,b.version=e[2].replace(/_/g,"."),b.ipad=!0),f&&(b.webos=!0,b.version=f[2]),g&&(b.blackberry=!0,b.version=g[2]),b}a.os=b(navigator.userAgent),a.__detect=b;var c=navigator.userAgent.match(/WebKit\/([\d.]+)/);a.browser=c?{webkit:!0,version:c[1]}:{webkit:!1}}(a),function(a,b){a.fn.anim=function(c,d,e,f){var g=[],h,i;for(i in c)i==="opacity"?h=c[i]:g.push(i+"("+c[i]+")");return a.isFunction(f)&&this.one("webkitTransitionEnd",f),this.css({"-webkit-transition":"all "+(d!==b?d:.5)+"s "+(e||""),"-webkit-transform":g.join(" "),opacity:h})}}(a),function(a){function e(){}var b=0,c=a.isObject,d;a.ajaxJSONP=function(c){var d="jsonp"+ ++b,e=document.createElement("script");window[d]=function(a){c.success(a),delete window[d]},e.src=c.url.replace(/=\?/,"="+d),a("head").append(e)},a.ajaxSettings={type:"GET",beforeSend:e,success:e,error:e,complete:e,accepts:{script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"}},a.ajax=function(b){b=b||{};var e=a.extend({},b);for(d in a.ajaxSettings)e[d]||(e[d]=a.ajaxSettings[d]);if(/=\?/.test(e.url))return a.ajaxJSONP(e);e.url||(e.url=window.location.toString()),e.data&&!e.contentType&&(e.contentType="application/x-www-form-urlencoded"),c(e.data)&&(e.contentType=="application/x-www-form-urlencoded"?e.data=a.param(e.data):e.contentType=="application/json"&&(e.data=JSON.stringify(e.data)));if(e.type.match(/get/i)&&e.data){var f=e.data;e.url.match(/\?.*=/)?f="&"+f:f[0]!="?"&&(f="?"+f),e.url+=f}var g=e.accepts[e.dataType],h=new XMLHttpRequest;e.headers=a.extend({"X-Requested-With":"XMLHttpRequest"},e.headers||{}),g&&(e.headers.Accept=g),h.onreadystatechange=function(){if(h.readyState==4){var a,b=!1;if(h.status>=200&&h.status<300||h.status==0){if(g=="application/json")try{a=JSON.parse(h.responseText)}catch(c){b=c}else a=h.responseText;b?e.error(h,"parsererror",b):e.success(a,"success",h)}else b=!0,e.error(h,"error");e.complete(h,b?"error":"success")}},h.open(e.type,e.url,!0);if(e.beforeSend(h,e)===!1)return h.abort(),!1;if(e.xhrFields)for(var i in e.xhrFields)h[i]=e.xhrFields[i];e.contentType&&(e.headers["Content-Type"]=e.contentType);for(name in e.headers)h.setRequestHeader(name,e.headers[name]);return h.send(e.data),h},a.get=function(b,c){a.ajax({url:b,success:c})},a.post=function(b,c,d,e){a.isFunction(c)&&(e=e||d,d=c,c=null),a.ajax({type:"POST",url:b,data:c,success:d,dataType:e})},a.getJSON=function(b,c){a.ajax({url:b,success:c,dataType:"json"})},a.fn.load=function(b,c){if(!this.length)return this;var d=this,e=b.split(/\s/),f;return e.length>1&&(b=e[0],f=e[1]),a.get(b,function(b){d.html(f?a(document.createElement("div")).html(b).find(f).html():b),c&&c()}),this},a.param=function(b,e){var f=[],g=function(a,b){f.push(encodeURIComponent(e?e+"["+a+"]":a)+"="+encodeURIComponent(b))},h=a.isArray(b);for(d in b)c(b[d])?f.push(a.param(b[d],e?e+"["+d+"]":d)):g(h?"":d,b[d]);return f.join("&").replace("%20","+")}}(a),function(a){function d(a){return"tagName"in a?a:a.parentNode}function e(a,b,c,d){var e=Math.abs(a-b),f=Math.abs(c-d);return e>=f?a-b>0?"Left":"Right":c-d>0?"Up":"Down"}var b={},c;a(document).ready(function(){a(document.body).bind("touchstart",function(a){var e=Date.now(),f=e-(b.last||e);b.target=d(a.touches[0].target),c&&clearTimeout(c),b.x1=a.touches[0].pageX,b.y1=a.touches[0].pageY,f>0&&f<=250&&(b.isDoubleTap=!0),b.last=e}).bind("touchmove",function(a){b.x2=a.touches[0].pageX,b.y2=a.touches[0].pageY}).bind("touchend",function(d){b.isDoubleTap?(a(b.target).trigger("doubleTap"),b={}):b.x2>0||b.y2>0?((Math.abs(b.x1-b.x2)>30||Math.abs(b.y1-b.y2)>30)&&a(b.target).trigger("swipe")&&a(b.target).trigger("swipe"+e(b.x1,b.x2,b.y1,b.y2)),b.x1=b.x2=b.y1=b.y2=b.last=0):"last"in b&&(c=setTimeout(function(){c=null,a(b.target).trigger("tap"),b={}},250))}).bind("touchcancel",function(){b={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap"].forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}})}(a),a}()},Joshfire.definedModules["joshfire/input"]=function(){return function(a){return a({__constructor:function(a){this.app=a},setup:function(a){a(null)}})}(Joshfire.loadModule("joshfire/class"))},Joshfire.definedModules["joshfire/adapters/ios/inputs/touch"]=function(){return function(a,b,c){return b(a,{setup:function(a){function d(){return"ontouchstart"in window}var b=this;c(window).live(d()?"touchstart click MozTouchDown":"mousedown click",function(a){for(var d=this;d&&d!=document;d=d.parentNode)if(c(d).attr("data-josh-ui-path")){var e=b.app.ui.element(c(d).attr("data-josh-ui-path"));(!e.hasScroller&&a.type!="click"||a.type=="click"&&e.hasScroller)&&e.publish("input",["enter",c(d).attr("data-josh-grid-id"),this],!0);break}}),d&&c(window).live("swipeLeft swipeRight swipeUp swipeDown",function(a){for(var d=this;d&&d!=document;d=d.parentNode)if(c(d).attr("data-josh-ui-path")){var e=b.app.ui.element(c(d).attr("data-josh-ui-path"));e.publish("swipe",[a.type.replace(/swipe/,"").toLowerCase(),c(d).attr("data-josh-grid-id"),this],!0);break}}),a(null)}})}(Joshfire.loadModule("joshfire/input"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/zepto"))},Joshfire.definedModules["joshfire/adapters/ios/app"]=function(){return function(a,b,c,d,e,f){return Joshfire.getScript=function(){},a(b,{getDefaultOptions:function(){return d.extend(this.__super(),{inputs:[f],autoInsert:!0,parentElement:document.body})},__constructor:function(a){var b=this;this.options=d.extend(this.getDefaultOptions(),a||{}),b.options.autoInsert&&b.subscribe("ready",function(){c.onReady(function(){b.insert(b.options.parentElement)})}),this.__super(a)},insert:function(a){var b=this;d.isString(a)?this.baseHtmlEl=document.getElementById(a):this.baseHtmlEl=a,this.publish("beforeInsert",[this.baseHtmlEl],!0);var c=this.ui.element("");c.insert(this.baseHtmlEl),this.publish("afterInsert")}})}(Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/app"),Joshfire.loadModule("joshfire/main"),Joshfire.loadModule("joshfire/vendor/underscore"),Joshfire.loadModule("joshfire/vendor/zepto"),Joshfire.loadModule("joshfire/adapters/ios/inputs/touch"))},Joshfire.definedModules["src/tree.data"]=function(){return function(a,b,c){return a(b,{buildTree:function(){var a=this,b=Joshfire.factory.config.datasources,d=[];c.each(b,function(a,b){c.isArray(a)?c.each(a,function(a,e){d.push(c.extend(Joshfire.factory.getDataSource(b).children[e],{id:b+e,name:a.name}))}):d.push(c.extend(Joshfire.factory.getDataSource(b),{id:b}))}),Joshfire.factory.config.template.options&&Joshfire.factory.config.template.options.abouthtml&&d.splice(d.length,0,{id:"about",config:{col:"about"},name:"About"});var e=[];return c.each(d,function(a,b){e.push({id:a.id,col:a.config.col,database:a.config.db,children:function(b,d){a.find({},function(a,b){var e=c.map(b.entries,function(a,b){return c.extend(a,{id:"#"+b})});d(null,e)})}})}),[{id:"datasourcelist",children:function(a,b){b(null,d)}},{id:"datasource",children:e}]}})}(Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/tree.data"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/uielements/list"]=function(){return function(a,b,c){return b(a,{type:"List",data:[],getDefaultOptions:function(){return c.extend(this.__super(),{persistSelection:!0,defaultSelection:[],multiple:!1,itemTemplate:"<%= itemInner %>",itemInnerTemplate:"<%= item.label %>",loadingTemplate:"Loading..."})},init:function(){this.setData(this.options.data||[]),this.setState("selection",this.options.defaultSelection)},setDataPath:function(a){a.match(/\/$/)||(a+="/"),this.__super(a)},resetSelection:function(){this.selectById(this.options.defaultSelection)},selectByIndex:function(a){c.isArray(a)||(a=[a]);var b=[];for(var d=0,e=a.length;d<e;d++)b[d]=this.data[a[d]].id;this.selectById(b)},selectById:function(a){var b=this;c.isArray(a)||(a=[a]);if(c.isEqual(this.selection,a))return;this.setState("selection",a),this.publish("select",[a]),this.app.data.publish("select",[c.map(a,function(a){return b.dataPath+a})])},getIndexById:function(a){for(var b=0,c=this.data.length;b<c;b++)if(this.data[b].id==a)return b;return null},getDataById:function(a){var b=this.getIndexById(a);return b?this.data[b]:null}})}(Joshfire.loadModule("joshfire/adapters/ios/uielement"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/utils/grid"]=function(){return function(a,b){return a({moves:{up:{down:[0,1],up:[0,-1],right:[1,0],left:[-1,0]},down:{down:[0,-1],up:[0,1],right:[1,0],left:[-1,0]},right:{down:[1,0],up:[-1,0],left:[0,1],right:[0,-1]},left:{down:[1,0],up:[-1,0],left:[0,-1],right:[0,1]}},__constructor:function(a){this.options=a,this.options.dimensions=a.dimensions||2,this.options.orientation=a.orientation||"down",this.options.direction=a.direction||"ltr",this.currentCoords=this.options.defaultPosition||!1,this.lastCoords=this.options.defaultPosition||!1,this.id2coords={},a.grid&&this.setGrid(a.grid),this.options.inputSource&&this.subscribeToInputEvents(this.options.inputSource)},setGrid:function(a){this.grid=a,this.id2coords={};for(var b=0;b<this.grid.length;b++)for(var c=0;c<this.grid[b].length;c++)this.grid[b][c]&&(this.id2coords[this.grid[b][c].id]=[c,b]);this.options.onGrid&&this.options.onGrid(this.grid)},getCoordinatesById:function(a){return this.id2coords[a]},get:function(a){return this.grid[a[1]][a[0]]},goTo:function(a){if(!this.currentCoords||a[0]!==this.currentCoords[0]||a[1]!==this.currentCoords[1])this.currentCoords=a,this.lastCoords=a,this.options.onChange&&this.get(this.currentCoords)&&this.options.onChange(this.currentCoords,this.get(this.currentCoords));this.options.onMove&&this.options.onMove(this.currentCoords,this.get(this.currentCoords))},goToId:function(a){return this.id2coords[a]?(this.goTo(this.id2coords[a]),!0):!1},go:function(a){if(a=="default")return this.goTo(this.options.defaultPosition);if(a=="last")return this.goTo(this.lastCoords);var c=this.moves[this.options.orientation][a][0]+this.currentCoords[0],d=this.moves[this.options.orientation][a][1]+this.currentCoords[1];if(d<0||d>=this.grid.length||!this.grid[d]||c<0||c>=this.grid[d].length||!this.grid[d][c]){if(this.options.sticky){if(this.grid[d]&&this.moves[this.options.orientation][a][0]==0){var e=!1;for(var f=0;f<this.grid[d].length;f++)this.grid[d][f]&&(e===!1||Math.abs(c-f)<Math.abs(c-e))&&(e=f);if(e!==!1){this.goTo([e,d]);return}}if(this.moves[this.options.orientation][a][1]==0){var g=!1;for(var h=0;h<this.grid.length;h++)this.grid[h]&&this.grid[h][c]&&(g===!1||Math.abs(d-h)<Math.abs(d-g))&&(g=h);if(g!==!1){this.goTo([c,g]);return}}}var i=this.moves[this.options.orientation][a].join("-"),j=!1;b.each(this.moves.down,function(a,b){a.join("-")==i&&(j=b)}),this.options.onExit&&this.options.onExit(a,j)}else this.goTo([c,d])},handleInput:function(a){var b=a[0];this.options.direction=="rtl"&&(this.options.orientation=="up"||this.options.orientation=="down")&&(b=="left"?b="right":b=="right"&&(b="left")),b=="left"||b=="right"||b=="down"||b=="up"?this.go(b):b=="hover"?this.goToId(a[1]):b=="enter"&&(this.goToId(a[1]),this.options.onValidate&&this.options.onValidate(this.currentCoords,this.get(this.currentCoords)))},subscribeToInputEvents:function(a){var b=this;a.subscribe("input",function(a,c){b.handleInput(c)})}})}(Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/adapters/android/uielements/list"]=function(){return function(a,b,c,d,e,f){return b(a,{getDefaultOptions:function(){return d.extend(this.__super(),{orientation:"up",incrementalRefresh:!1,itemTemplate:"<li id='<%=itemHtmlId%>' data-josh-ui-path='<%= path %>' data-josh-grid-id='<%= item.id %>' class='josh-"+this.type+" joshover'><%= itemInner %></li>",scroller:!0})},init:function(){var a=this;a.__super(),a.scrollOptions=d.extend({},a.options.scrollOptions,{active:a.options.scroller||!1}),a.options.scrollBarClass&&(a.scrollOptions.scrollbarClass=a.options.scrollBarClass),a.setData(a.data),a.subscribe("focusItem",function(b,c){a._applyFocus(c[0])}),a.subscribe("input",function(b,c){if(c.length>=2&&c[0]=="enter"){if(c[1]=="__lastItem"){a.publish("lastItemSelect");return}if(c[1]===undefined)return;a.selectById(c[1])}}),a.subscribe("beforeBlur",function(b,c){f("#"+a.htmlId+" .focused").removeClass("focused")}),a.subscribe("select",function(b,c){var d=c[0];f("#"+a.htmlId+" .selected").removeClass("selected");for(var e=0,g=d.length;e<g;e++)f("#"+a.getItemHtmlId(d[e])).addClass("selected")})},insertScroller:function(){var a=this;if(!a.scrollOptions||!a.getState("inserted"))return;this.hasScroller=!0,a.scrollOptions.active&&a.data&&a.data.length&&a.htmlEl.children.length&&(a.iScroller&&a.iScroller.destroy(),a.iScroller=new e(a.htmlId,a.scrollOptions),document.addEventListener("orientationChanged",function(b){a.iScroller&&a.iScroller.refresh()}))},insert:function(a,b){var c=this;document.addEventListener("touchmove",function(a){a.preventDefault()},!1),c.__super(a,b),c.subscribe("afterShow",function(){c.insertScroller()})},_applyFocus:function(a){var b=this;f("#"+b.htmlId+" .focused").removeClass("focused"),f("#"+b.getItemHtmlId(a)).addClass("focused"),!b.options.autoScroll},focusByIndex:function(a){this.focusById(this.data[a].id)},focusById:function(a){if(this.getState("focus")==a)return;this.setState("focus",a),this.publish("focusItem",[a]),this.focus()},getItemHtmlId:function(a){return this.getHtmlId()+"_"+a.toString().replace(/[^-A-Za-z0-9_:.]/,"-")},getInnerHtml:function(){return this.isLoading?this.template(this.options.loadingTemplate):'<div class="'+this.htmlId+'_scroller"><ul>'+this._getItemsHtml(0)+"</ul></div>"},_getItemsHtml:function(a){var b=[],c=d.isFunction(this.options.itemTemplate)?this.options.itemTemplate:d.template(this.options.itemTemplate),e=d.isFunction(this.options.itemInnerTemplate)?this.options.itemInnerTemplate:d.template(this.options.itemInnerTemplate);if(!this.data)return"";for(var f=a,g=this.data.length;f<g;f++)this.item=this.data[f],this.i=f,this.itemInner=e(this),this.itemHtmlId=this.getItemHtmlId(this.data[f].id),b.push(c(this));if(this.options.lastItemInnerTemplate){var h=d.isFunction(this.options.lastItemInnerTemplate)?this.options.lastItemInnerTemplate:d.template(this.options.lastItemInnerTemplate);this.item={id:"__lastItem"},this.i="last",this.itemInner=h(this),this.itemHtmlId=this.getItemHtmlId("__lastItem"),b.push(c(this))}return b.join("")},refresh:function(){var a=this;if(this.options.incrementalRefresh&&f("#"+this.htmlId+" ul").size()){var b=0,c=f("#"+this.htmlId+" li");if(c.slice)for(var d=0;d<this.data.length;d++){if(c.slice(d,d+1).attr("data-josh-grid-id")!=this.data[d].id){b=d;break}c.slice(b).remove()}f("#"+this.htmlId+" ul").append(this._getItemsHtml(b)),this.publish("afterRefresh")}else a.iScroller&&(a.iScroller.destroy(),a.iScroller=null),this.__super(),this.insertScroller();setTimeout(function(){a.iScroller&&a.iScroller.refresh()},0);var e=this.getState("focus");e&&this._applyFocus(e)},setLoading:function(a){this.iScroller&&a&&(this.iScroller.destroy(),this.iScroller=null),this.__super(a)}})}(Joshfire.loadModule("joshfire/uielements/list"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/utils/grid"),Joshfire.loadModule("joshfire/vendor/underscore"),Joshfire.loadModule("joshfire/vendor/iscroll"),Joshfire.loadModule("joshfire/vendor/zepto"))},Joshfire.definedModules["joshfire/adapters/ios/uielements/list"]=function(){return function(a,b,c){return a}(Joshfire.loadModule("joshfire/adapters/android/uielements/list"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/uielements/panel.manager"]=function(){return function(a,b,c){return b(a,{init:function(){var a=this;a.__super(),a.lastSequenceId=0,a.subscribe("state",function(b,c){c[0]=="route"&&a.route(c[1])}),a.currentId=!1},switchTo:function(a){var b=this;b.currentPanelId=a,c.each(b.children,function(c){c.path==b.path+"/"+a?b.app.ui.element(c.path).show():b.app.ui.element(c.path).hide()})},setup:function(a){var b=this;b.options.uiMaster&&b.app.ui.fetch(b.options.uiMaster,!1,function(a,c){var d=b.app.ui.element(b.options.uiMaster);d.subscribe("select",function(a,c){return!c.length||b.app.ui.get(b.path+"/"+c[0][0])===undefined?!1:(b.switchTo(c[0][0]),!0)})}),a()},initView:function(a,b){var d=this;c.isString(a)&&Joshfire.require([this.options.requirePrefix+a],function(c){if(!c)return b("no such view");var e=new c(d.app,d.path+"/"+a,{sequenceId:d.lastSequenceId++});return b(null,e)})}})}(Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["joshfire/uielements/button"]=function(){return function(a,b){return b(a,{type:"Button",getHtml:function(){return this.template('<input type="button" class="joshover josh-type-<%=type%> josh-id-<%=id%> <%= htmlClass %>"  data-josh-ui-path="'+this.path+'" id="'+this.htmlId+'" value="'+this.options.label+'" />')},setLabel:function(a){this.htmlEl.value=a},init:function(){var a=this;a.__super(),a.subscribe("input",function(b,c){if(!c||c.length==0)return;switch(c[0]){case"enter":a.publish("select",[a.id])}})}})}(Joshfire.loadModule("joshfire/adapters/ios/uielement"),Joshfire.loadModule("joshfire/class"))},Joshfire.definedModules["joshfire/uielements/video"]=function(){return function(a,b){return b(a,{type:"Video",isDefaultPlayer:!0,init:function(){},play:function(a){if(!a||!a.url)return;var b=this;if(typeof a.url!="function")return b.playWithStaticUrl(a);a.url(function(c,d){if(c)return b.error(4);a.url=d,b.playWithStaticUrl(a)})},playPrev:function(){},playNext:function(){var a=this,b=a.app.tree.getData(a.treeCurrent).playlistNext||["next"];a.app.tree.resolveMoves(a.treeCurrent,b,!1,function(b){a.app.tree.moveTo("focus",b),a.app.publish("input",["enter"])})},pause:function(){return},refresh:function(){},getHtml:function(){return""}})}(Joshfire.loadModule("joshfire/adapters/ios/uielement"),Joshfire.loadModule("joshfire/class"))},Joshfire.definedModules["joshfire/adapters/ios/uielements/video.youtube"]=function(){return function(a,b,c,d){return b(a,{init:function(){this.__super()},playWithStaticUrl:function(a){var b=this,d=b.options.controls?" controls":"";if(b.options.width)var e=b.options.width;else var e=c(this.htmlEl).width();var f=parseInt(e*9/16);this.htmlEl.innerHTML='<iframe width="'+e+'" height="'+f+'" '+'src="http://www.youtube.com/embed/'+a.url+'?rel=0" frameborder="0" allowfullscreen></iframe>'},pause:function(){},stop:function(){this.htmlEl.innerHTML=""},getHtml:function(){return"<div class='josh-type-"+this.type+"' id='"+this.htmlId+"'></div>"}})}(Joshfire.loadModule("joshfire/uielements/video"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/zepto"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["src/src/ui-components"]=function(){return function(a,b,c,d,e){return{tplHeader:'<% if(Joshfire.factory.config.app.logo) { %><div class="titleLogo"><img class="applogo" src="<%= Joshfire.factory.config.app.logo.contentURL %>" alt="<%= Joshfire.factory.config.app.name %>" /></div><% } else { %><div class="title"><%= Joshfire.factory.config.app.name %></div><% } %>',tplTweetItem:'<div class="tweet"><div class="tweet-header"><% if (item.author) { %><% if (item.author[0] && item.author[0].image) { %><img src="<%= item.author[0].image.contentURL %>" alt="" /><% } %><p class="user"><span class="name"><%= item.author[0].name %></span><% if (item.author[0]["foaf:nick"]) { %> <span class="login">@<%= item.author[0]["foaf:nick"] %></span><% } %></p><% } %></div><div class="tweet-content"><p class="content"><%= item.name %></p><p class="date"><%= prettyDate(item.datePublished) %></p></div></div>',tplTweetPage:'<div class="tweet"><div class="tweet-header"><% if (data.author) { %><% if (data.author[0] && data.author[0].image) { %><img src="<%= data.author[0].image.contentURL %>" alt="" /><% } %><p class="username"><%= data.author[0].name %></p><% if (data.author[0]["foaf:nick"]) { %> <p class="userlogin">@<%= data.author[0]["foaf:nick"] %></p><% } %><% } %></div><div class="tweet-content"><p class="content linkify"><%= data.name %></p><p class="date"><%= data.datePublished ? toDate(data.datePublished).toString().substring(0, 21) : "" %></p></div></div>',tplEventItem:'<div class="event"><% var d = toDate(item.startDate); %><p class="startDateDay"><span class="date"><%= d.toDateString() %></span><span class="localedate"><%= d.toLocaleDateString() %></span></p><p class="startDate"><%= d.toTimeString().substring(0, 5) %></p><p class="content"><%= item.name %></p></div>',tplEventPage:'<div class="event"><div class="coords"><p class="Day"><span class="date"><%= data.startDate ? toDate(data.startDate).toDateString() : "" %></span><span class="localedate"><%= data.startDate ? toDate(data.startDate).toLocaleDateString() : "" %></span></p><p class="startDate"><span class="time"><%= data.startDate ? toDate(data.startDate).toTimeString().substring(0, 5) : "" %></span></p><p class="endDate"><%= data.endDate ? toDate(data.endDate).toTimeString().substring(0, 5) : "" %></p><% if (data.location) { %><p class="location"><%= data.location.name %></p><% } %></div><div class="event-content"><h2 class="name"><%= data.name %></h2><p class="description"><%= data.description %></p></div></div>',tplItemPreview:'<% if (item.image) { %><div class="preview"><img src="<%= item.image.contentURL %>"></div><% } %>',tplItemThumbnail:'<% if (item.image && item.image.contentURL) { %><div class="thumbnail" style="background-image:url(\'<%=item.image.contentURL%>\')"></div><% } %>',tplDataAuthor:'<% if (data.author && data.author[0] && data.author[0].name) { %><p class="author">By <strong><%= data.author[0].name %></strong></p><% } %>',tplAboutPage:'<div class="aboutpage"><div class="abouthtml"><%= Joshfire.factory.config.template.options.abouthtml %></div></div>',tplNothingToSeeHere:'<div class="empty-list"><p>Empty</p></div>',getItemDescriptionTemplate:function(a){return'<% if (item.description) { %><div class="abstract"><% if (item.description.length > '+a+") {"+"print(item.description.substring(0, "+a+') + "…");'+"} else {"+"print(item.description); "+"} %>"+"</div>"+"<% } %>"}}}(Joshfire.loadModule("joshfire/adapters/ios/uielements/list"),Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"),Joshfire.loadModule("joshfire/uielements/panel.manager"),Joshfire.loadModule("joshfire/uielements/button"),Joshfire.loadModule("joshfire/adapters/ios/uielements/video.youtube"))},Joshfire.definedModules["src/src/src/ui-components"]=function(){return function(a,b,c,d,e){return{tplHeader:'<% if(Joshfire.factory.config.app.logo) { %><div class="titleLogo"><img class="applogo" src="<%= Joshfire.factory.config.app.logo.contentURL %>" alt="<%= Joshfire.factory.config.app.name %>" /></div><% } else { %><div class="title"><%= Joshfire.factory.config.app.name %></div><% } %>',tplTweetItem:'<div class="tweet"><div class="tweet-header"><% if (item.author) { %><% if (item.author[0] && item.author[0].image) { %><img src="<%= item.author[0].image.contentURL %>" alt="" /><% } %><p class="user"><span class="name"><%= item.author[0].name %></span><% if (item.author[0]["foaf:nick"]) { %> <span class="login">@<%= item.author[0]["foaf:nick"] %></span><% } %></p><% } %></div><div class="tweet-content"><p class="content"><%= item.name %></p><p class="date"><%= prettyDate(item.datePublished) %></p></div></div>',tplTweetPage:'<div class="tweet"><div class="tweet-header"><% if (data.author) { %><% if (data.author[0] && data.author[0].image) { %><img src="<%= data.author[0].image.contentURL %>" alt="" /><% } %><p class="username"><%= data.author[0].name %></p><% if (data.author[0]["foaf:nick"]) { %> <p class="userlogin">@<%= data.author[0]["foaf:nick"] %></p><% } %><% } %></div><div class="tweet-content"><p class="content linkify"><%= data.name %></p><p class="date"><%= data.datePublished ? toDate(data.datePublished).toString().substring(0, 21) : "" %></p></div></div>',tplEventItem:'<div class="event"><% var d = toDate(item.startDate); %><p class="startDateDay"><span class="date"><%= d.toDateString() %></span><span class="localedate"><%= d.toLocaleDateString() %></span></p><p class="startDate"><%= d.toTimeString().substring(0, 5) %></p><p class="content"><%= item.name %></p></div>',tplEventPage:'<div class="event"><div class="coords"><p class="Day"><span class="date"><%= data.startDate ? toDate(data.startDate).toDateString() : "" %></span><span class="localedate"><%= data.startDate ? toDate(data.startDate).toLocaleDateString() : "" %></span></p><p class="startDate"><span class="time"><%= data.startDate ? toDate(data.startDate).toTimeString().substring(0, 5) : "" %></span></p><p class="endDate"><%= data.endDate ? toDate(data.endDate).toTimeString().substring(0, 5) : "" %></p><% if (data.location) { %><p class="location"><%= data.location.name %></p><% } %></div><div class="event-content"><h2 class="name"><%= data.name %></h2><p class="description"><%= data.description %></p></div></div>',tplItemPreview:'<% if (item.image) { %><div class="preview"><img src="<%= item.image.contentURL %>"></div><% } %>',tplItemThumbnail:'<% if (item.image && item.image.contentURL) { %><div class="thumbnail" style="background-image:url(\'<%=item.image.contentURL%>\')"></div><% } %>',tplDataAuthor:'<% if (data.author && data.author[0] && data.author[0].name) { %><p class="author">By <strong><%= data.author[0].name %></strong></p><% } %>',tplAboutPage:'<div class="aboutpage"><div class="abouthtml"><%= Joshfire.factory.config.template.options.abouthtml %></div></div>',tplNothingToSeeHere:'<div class="empty-list"><p>Empty</p></div>',getItemDescriptionTemplate:function(a){return'<% if (item.description) { %><div class="abstract"><% if (item.description.length > '+a+") {"+"print(item.description.substring(0, "+a+') + "…");'+"} else {"+"print(item.description); "+"} %>"+"</div>"+"<% } %>"}}}(Joshfire.loadModule("joshfire/adapters/ios/uielements/list"),Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"),Joshfire.loadModule("joshfire/uielements/panel.manager"),Joshfire.loadModule("joshfire/uielements/button"),Joshfire.loadModule("joshfire/adapters/ios/uielements/video.youtube"))},Joshfire.definedModules["src/src/ui-fragments"]=function(){return function(a,b,c,d,e,f,g,h){return{itemList:function(a){a=a||{},a.toGrid=a.toGrid||["ImageObject"];var b="(item['@type'] || item.itemType) === '"+a.toGrid[0]+"'";for(var d=1;d<a.toGrid.length;d++)b+=" || (item['@type'] || item.itemType) === '"+a.toGrid[d]+"'";return{id:"itemList",scroller:!0,scrollOptions:{useTransition:!0},type:c,htmlClass:"itemList",loadingTemplate:'<div class="loading"></div>',itemTemplate:"<li id='<%=itemHtmlId%>' data-josh-ui-path='<%= path %>' data-josh-grid-id='<%= item.id %>'class='josh-List joshover item-<%= (item['@type'] || item.itemType).replace('/', '') %> mainitemlist <% if ("+b+") { %>"+" grid"+"<% } else { %>"+" list"+"<% } %>"+"' >"+"<%= itemInner %>"+"</li>",itemInnerTemplate:'<% if ((item["@type"] || item.itemType) === "ImageObject") { %>'+g.tplItemThumbnail+'<% } else if ((item["@type"] || item.itemType) === "Article/Status") { %>'+g.tplTweetItem+'<% } else if ((item["@type"] || item.itemType) === "Event") { %>'+g.tplEventItem+'<% } else if ((item["@type"] || item.itemType) === "Article" && item.url && item.url.indexOf("spreadsheets.google.com") != -1) { %>'+'<div class="directory">'+g.tplItemThumbnail+'<p class="name"><%= item.name %></p>'+'<p class="description"><%= item.description %></p>'+'<span class="list-arrow"></span>'+"</div>"+"<% } else { %>"+g.tplItemPreview+'<div class="title"><%= item.name %></div>'+g.getItemDescriptionTemplate(70)+'<span class="list-arrow"></span>'+"<% } %>"}},title:function(){return{id:"title",type:d,innerTemplate:g.tplHeader}},menu:function(a){return a=a||{id:"menu"},{id:a.id,type:c,htmlClass:"menu",dataPath:"/datasourcelist/",itemInnerTemplate:'<div class="picto item-<%= item.config.col %>"></div><div class="name"><%= item.name %></div>',onData:function(a){}}},detail:function(a){return a=a||{},a.videoPanelType=a.videoPanelType||"video.youtube",{id:"detail",type:d,htmlClass:"detailView",loadingTemplate:'<div class="loading"></div>',uiDataMaster:a.uiDataMaster,autoShow:!1,children:[{id:"article",htmlClass:"detailViewItem",type:d,scroller:!0,scrollOptions:{useTransition:!0},uiDataMaster:a.uiDataMaster,loadingTemplate:'<div class="loading"></div>',innerTemplate:'<div><div class="title"><h1><% if (data && data.name) { print(data.name); } %></h1>'+g.tplDataAuthor+"</div>"+'<div class="body">'+"<% if (data.articleBody) { print(data.articleBody); } %>"+"</div>"+"</div>",onData:function(b){var c=a.app.ui.element(a.treePosition+"/detail/article").htmlEl,d=b.data["@type"]||b.data.itemType;d==="VideoObject"||d==="ImageObject"||d==="Article/Status"||d==="Event"||d==="Article"&&b.data.url&&b.data.url.indexOf("spreadsheets.google.com")!=-1?$(c).hide():$(c).show()},onAfterRefresh:function(){a.app.ui.element(a.treePosition+"/detail/article").insertScroller()}},{id:"twitter",htmlClass:"detailViewItem",type:d,uiDataMaster:a.uiDataMaster,scroller:!0,scrollOptions:{useTransition:!0},loadingTemplate:'<div class="loading"></div>',innerTemplate:g.tplTweetPage,onData:function(b){var c=a.app.ui.element(a.treePosition+"/detail/twitter").htmlEl;(b.data["@type"]||b.data.itemType)==="Article/Status"?$(c).show():$(c).hide()},onAfterRefresh:function(){a.app.ui.element(a.treePosition+"/detail/twitter").insertScroller()}},{id:"google",htmlClass:"detailViewItem",type:d,scroller:!0,scrollOptions:{useTransition:!0},uiDataMaster:a.uiDataMaster,loadingTemplate:'<div class="loading"></div>',innerTemplate:'<div class="directory"><% if (data.image) { %><div class="picture"><img src="<%= data.image.contentURL %>"></div><% } %><p class="name"><%= data.name %></p><p class="description"><%= data.description %></p><% if (data.articleBody) { %><p class="content"><%= data.articleBody %></p><% } %></div>',onData:function(b){var c=a.app.ui.element(a.treePosition+"/detail/google").htmlEl;(b.data["@type"]||b.data.itemType)==="Article"&&b.data.url&&b.data.url.indexOf("spreadsheets.google.com")!=-1?$(c).show():$(
c).hide()},onAfterRefresh:function(){a.app.ui.element(a.treePosition+"/detail/google").insertScroller()}},{id:"image",type:d,htmlClass:"detailViewItem",scroller:!0,scrollOptions:{useTransition:!0},uiDataMaster:a.uiDataMaster,loadingTemplate:'<div class="loading"></div>',innerTemplate:'<img class="picture-fullscreen" src="<%= data.contentURL %>" alt="" />',onData:function(b){var c=a.app.ui.element(a.treePosition+"/detail/image").htmlEl;(b.data["@type"]||b.data.itemType)==="ImageObject"?$(c).show():$(c).hide()},onAfterRefresh:function(){a.app.ui.element(a.treePosition+"/detail/image").insertScroller()}},{id:"event",type:d,htmlClass:"detailViewItem",scroller:!0,scrollOptions:{useTransition:!0},uiDataMaster:a.uiDataMaster,loadingTemplate:'<div class="loading"></div>',innerTemplate:g.tplEventPage,onData:function(b){var c=a.app.ui.element(a.treePosition+"/detail/event").htmlEl;(b.data["@type"]||b.data.itemType)==="Event"?$(c).show():$(c).hide()},onAfterRefresh:function(){a.app.ui.element(a.treePosition+"/detail/event").insertScroller()}},{id:"video",type:d,htmlClass:"detailViewItem",scroller:!0,scrollOptions:{useTransition:!0},loadingTemplate:'<div class="loading"></div>',uiDataMaster:a.uiDataMaster,innerTemplate:'<div class="title"><h1><%= data.name %></h1>'+g.tplDataAuthor+"</div>"+'<div class="videoplayer"></div>',onData:function(b){var c=a.app.ui.element(a.treePosition+"/detail/video").htmlEl;(b.data["@type"]||b.data.itemType)==="VideoObject"?$(c).show():$(c).hide()},onAfterRefresh:function(){var b=a.app.ui.element(a.treePosition+"/detail/video");mediaFactory.resolve(b.data,{width:$(b.htmlEl).width()}).toHtml(function(a,c){mediaFactory.insertFragment(c,$(".videoplayer",$(b.htmlEl)).get(0))}),b.insertScroller()}}]}},about:function(a,b){return{id:"about",scroller:!0,scrollOptions:{useTransition:!0},type:d,htmlClass:"about",loadingTemplate:'<div class="loading"></div>',autoShow:!1,innerTemplate:g.tplAboutPage,onAfterRefresh:function(){a.ui.element(b+"/about").insertScroller()}}}}}(Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/tree.ui"),Joshfire.loadModule("joshfire/adapters/ios/uielements/list"),Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"),Joshfire.loadModule("joshfire/uielements/panel.manager"),Joshfire.loadModule("joshfire/uielements/button"),Joshfire.loadModule("src/src/src/ui-components"))},Joshfire.definedModules["src/tree.ui.tablet"]=function(){return function(a,b,c,d,e,f,g,h,i){return a(b,{buildTree:function(){var a=this.app;return[{id:"header",type:d,children:[i.title(),i.menu()]},{id:"content",type:e,uiMaster:"/header/menu",children:[i.itemList({toGrid:["ImageObject"]}),i.detail({app:a,treePosition:"/content",uiDataMaster:"/content/itemList"}),i.about(a,"/content")]}]}})}(Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/tree.ui"),Joshfire.loadModule("joshfire/adapters/ios/uielements/list"),Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"),Joshfire.loadModule("joshfire/uielements/panel.manager"),Joshfire.loadModule("joshfire/uielements/button"),Joshfire.loadModule("joshfire/adapters/ios/uielements/video.youtube"),Joshfire.loadModule("src/src/ui-components"),Joshfire.loadModule("src/src/ui-fragments"))},Joshfire.definedModules["joshfire/utils/splashscreen"]=function(){return function(a,b){return a({__constructor:function(a){a=b.extend({htmlId:"splashscreen"},a),this.id=a.htmlId;if(a.timeout){var c=this;setTimeout(function(){c.remove()},a.timeout)}},remove:function(a){document&&(document.getElementById(this.id).style.display="none")}})}(Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("joshfire/vendor/underscore"))},Joshfire.definedModules["src/lib/ba-linkify"]=function(){return function(){var a=function(){var a="[a-z\\d.-]+://",b="(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])",c="(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+",d="(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)",e="(?:"+c+d+"|"+b+")",f="(?:[;/][^#?<>\\s]*)?",g="(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?",h="\\b"+a+"[^<>\\s]+",i="\\b"+e+f+g+"(?!\\w)",j="mailto:",k="(?:"+j+")?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@"+e+g+"(?!\\w)",l=new RegExp("(?:"+h+"|"+i+"|"+k+")","ig"),m=new RegExp("^"+a,"i"),n={"'":"`",">":"<",")":"(","]":"[","}":"{","Â»":"Â«","â€º":"â€¹"},o={callback:function(a,b){return b?'<a href="'+b+'" title="'+b+'">'+a+"</a>":a},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};return function(a,b){b=b||{};var c,d,e,f,g="",h=[],i,k,p,q,r,s,t,u;for(d in o)b[d]===undefined&&(b[d]=o[d]);while(c=l.exec(a)){e=c[0],k=l.lastIndex,p=k-e.length;if(/[\/:]/.test(a.charAt(p-1)))continue;do q=e,u=e.substr(-1),t=n[u],t&&(r=e.match(new RegExp("\\"+t+"(?!$)","g")),s=e.match(new RegExp("\\"+u,"g")),(r?r.length:0)<(s?s.length:0)&&(e=e.substr(0,e.length-1),k--)),b.punct_regexp&&(e=e.replace(b.punct_regexp,function(a){return k-=a.length,""}));while(e.length&&e!==q);f=e,m.test(f)||(f=(f.indexOf("@")!==-1?f.indexOf(j)?j:"":f.indexOf("irc.")?f.indexOf("ftp.")?"http://":"ftp://":"irc://")+f),i!=p&&(h.push([a.slice(i,p)]),i=k),h.push([e,f])}h.push([a.substr(i)]);for(d=0;d<h.length;d++)g+=b.callback.apply(window,h[d]);return g||a}}();return a}()},Joshfire.definedModules["src/ui-components"]=function(){return function(a,b,c,d,e){return{tplHeader:'<% if(Joshfire.factory.config.app.logo) { %><div class="titleLogo"><img class="applogo" src="<%= Joshfire.factory.config.app.logo.contentURL %>" alt="<%= Joshfire.factory.config.app.name %>" /></div><% } else { %><div class="title"><%= Joshfire.factory.config.app.name %></div><% } %>',tplTweetItem:'<div class="tweet"><div class="tweet-header"><% if (item.author) { %><% if (item.author[0] && item.author[0].image) { %><img src="<%= item.author[0].image.contentURL %>" alt="" /><% } %><p class="user"><span class="name"><%= item.author[0].name %></span><% if (item.author[0]["foaf:nick"]) { %> <span class="login">@<%= item.author[0]["foaf:nick"] %></span><% } %></p><% } %></div><div class="tweet-content"><p class="content"><%= item.name %></p><p class="date"><%= prettyDate(item.datePublished) %></p></div></div>',tplTweetPage:'<div class="tweet"><div class="tweet-header"><% if (data.author) { %><% if (data.author[0] && data.author[0].image) { %><img src="<%= data.author[0].image.contentURL %>" alt="" /><% } %><p class="username"><%= data.author[0].name %></p><% if (data.author[0]["foaf:nick"]) { %> <p class="userlogin">@<%= data.author[0]["foaf:nick"] %></p><% } %><% } %></div><div class="tweet-content"><p class="content linkify"><%= data.name %></p><p class="date"><%= data.datePublished ? toDate(data.datePublished).toString().substring(0, 21) : "" %></p></div></div>',tplEventItem:'<div class="event"><% var d = toDate(item.startDate); %><p class="startDateDay"><span class="date"><%= d.toDateString() %></span><span class="localedate"><%= d.toLocaleDateString() %></span></p><p class="startDate"><%= d.toTimeString().substring(0, 5) %></p><p class="content"><%= item.name %></p></div>',tplEventPage:'<div class="event"><div class="coords"><p class="Day"><span class="date"><%= data.startDate ? toDate(data.startDate).toDateString() : "" %></span><span class="localedate"><%= data.startDate ? toDate(data.startDate).toLocaleDateString() : "" %></span></p><p class="startDate"><span class="time"><%= data.startDate ? toDate(data.startDate).toTimeString().substring(0, 5) : "" %></span></p><p class="endDate"><%= data.endDate ? toDate(data.endDate).toTimeString().substring(0, 5) : "" %></p><% if (data.location) { %><p class="location"><%= data.location.name %></p><% } %></div><div class="event-content"><h2 class="name"><%= data.name %></h2><p class="description"><%= data.description %></p></div></div>',tplItemPreview:'<% if (item.image) { %><div class="preview"><img src="<%= item.image.contentURL %>"></div><% } %>',tplItemThumbnail:'<% if (item.image && item.image.contentURL) { %><div class="thumbnail" style="background-image:url(\'<%=item.image.contentURL%>\')"></div><% } %>',tplDataAuthor:'<% if (data.author && data.author[0] && data.author[0].name) { %><p class="author">By <strong><%= data.author[0].name %></strong></p><% } %>',tplAboutPage:'<div class="aboutpage"><div class="abouthtml"><%= Joshfire.factory.config.template.options.abouthtml %></div></div>',tplNothingToSeeHere:'<div class="empty-list"><p>Empty</p></div>',getItemDescriptionTemplate:function(a){return'<% if (item.description) { %><div class="abstract"><% if (item.description.length > '+a+") {"+"print(item.description.substring(0, "+a+') + "…");'+"} else {"+"print(item.description); "+"} %>"+"</div>"+"<% } %>"}}}(Joshfire.loadModule("joshfire/adapters/ios/uielements/list"),Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"),Joshfire.loadModule("joshfire/uielements/panel.manager"),Joshfire.loadModule("joshfire/uielements/button"),Joshfire.loadModule("joshfire/adapters/ios/uielements/video.youtube"))},Joshfire.definedModules["app.tablet"]=function(){return function(a,b,c,d,e,f,g,h){return b(a,{id:"defaultApp",uiClass:d,dataClass:c,setup:function(a){var b=this,c=b.ui.element("/header/menu"),d=b.ui.element("/content/itemList"),f=b.ui.element("/content/detail"),i=b.ui.element("/content/detail/twitter"),j=b.ui.element("/content/detail/article"),k=b.ui.element("/header/title");this.splash=new e,document.title=Joshfire.factory.config.app.name,c.subscribe("data",function(a,d){b.splash.remove(),c.selectByIndex(0)}),c.subscribe("select",function(a,c){var e=c[0][0];if(e=="about"){b.ui.element("/content/about").show();return}d.setDataPath("/datasource/"+e+"/");var g;for(var h=0;h<b.data.tree["/datasource/"].length;h++)b.data.tree["/datasource/"][h].id==e&&(g=b.data.tree["/datasource/"][h].col);var i="fullSize";g=="photos"||g=="videos"?d.hasHtmlClass(i)||(d.addHtmlClass(i),f.addHtmlClass(i)):(d.removeHtmlClass(i),f.removeHtmlClass(i)),b.ui.element("/content").switchTo("itemList")}),i.subscribe("afterRefresh",function(a,b){var c=function(a,b){return b?'<a href="'+b+'" title="'+b+'" rel="external" target="_blank">'+a+"</a>":a};$(".linkify").html(g($(".linkify").text(),{callback:c}))}),j.subscribe("afterRefresh",function(a,b){$("a",j.htmlEl).attr("target","_blank").attr("rel","external")}),d.subscribe("select",function(a,c){b.ui.element("/content/detail").show()}),d.subscribe("afterRefresh",function(a,b){var c=$("#defaultApp__content__itemList li");c.length==0&&$("#defaultApp__content__itemList").html(h.tplNothingToSeeHere),$("#defaultApp__content__itemList li.grid").length>0&&($("#defaultApp__content__itemList ul li").last().hasClass("clearfix")||$("#defaultApp__content__itemList ul").append('<li class="clearfix"></li>'))}),a(null,!0)}})}(Joshfire.loadModule("joshfire/adapters/ios/app"),Joshfire.loadModule("joshfire/class"),Joshfire.loadModule("src/tree.data"),Joshfire.loadModule("src/tree.ui.tablet"),Joshfire.loadModule("joshfire/utils/splashscreen"),Joshfire.loadModule("joshfire/adapters/ios/uielements/panel"),Joshfire.loadModule("src/lib/ba-linkify"),Joshfire.loadModule("src/ui-components"))};